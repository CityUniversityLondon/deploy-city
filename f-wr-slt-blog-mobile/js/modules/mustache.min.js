!function(e,t){"object"==typeof exports&&exports?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.Mustache={})}(this,function(x){var t=Object.prototype.toString,U=Array.isArray||function(e){return"[object Array]"===t.call(e)};function f(e){return"function"==typeof e}function m(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var n=RegExp.prototype.test;var r=/\S/;function E(e){return!function(e,t){return n.call(e,t)}(r,e)}var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};var T=/\s*/,j=/\s+/,C=/\s*=/,A=/\s*\}/,R=/#|\^|\/|>|\{|&|=|!/;function S(e){this.string=e,this.tail=e,this.pos=0}function s(e,t){this.view=null==e?{}:e,this.cache={".":this.view},this.parent=t}function e(){this.cache={}}S.prototype.eos=function(){return""===this.tail},S.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},S.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},s.prototype.push=function(e){return new s(e,this)},s.prototype.lookup=function(e){var t,n=this.cache;if(e in n)t=n[e];else{for(var r,i,s=this;s;){if(0<e.indexOf("."))for(t=s.view,r=e.split("."),i=0;null!=t&&i<r.length;)t=t[r[i++]];else t=s.view[e];if(null!=t)break;s=s.parent}n[e]=t}return f(t)&&(t=t.call(this.view)),t},e.prototype.clearCache=function(){this.cache={}},e.prototype.parse=function(e,t){var n=this.cache,r=n[e];return null==r&&(r=n[e]=function(e,t){if(!e)return[];var n,r,i,s=[],o=[],a=[],c=!1,u=!1;function h(){if(c&&!u)for(;a.length;)delete o[a.pop()];else a=[];u=c=!1}function l(e){if("string"==typeof e&&(e=e.split(j,2)),!U(e)||2!==e.length)throw new Error("Invalid tags: "+e);n=new RegExp(m(e[0])+"\\s*"),r=new RegExp("\\s*"+m(e[1])),i=new RegExp("\\s*"+m("}"+e[1]))}l(t||x.tags);for(var p,f,g,v,w,d,k=new S(e);!k.eos();){if(p=k.pos,g=k.scanUntil(n))for(var y=0,b=g.length;y<b;++y)E(v=g.charAt(y))?a.push(o.length):u=!0,o.push(["text",v,p,p+1]),p+=1,"\n"===v&&h();if(!k.scan(n))break;if(c=!0,f=k.scan(R)||"name",k.scan(T),"="===f?(g=k.scanUntil(C),k.scan(C),k.scanUntil(r)):"{"===f?(g=k.scanUntil(i),k.scan(A),k.scanUntil(r),f="&"):g=k.scanUntil(r),!k.scan(r))throw new Error("Unclosed tag at "+k.pos);if(w=[f,g,p,k.pos],o.push(w),"#"===f||"^"===f)s.push(w);else if("/"===f){if(!(d=s.pop()))throw new Error('Unopened section "'+g+'" at '+p);if(d[1]!==g)throw new Error('Unclosed section "'+d[1]+'" at '+p)}else"name"===f||"{"===f||"&"===f?u=!0:"="===f&&l(g)}if(d=s.pop())throw new Error('Unclosed section "'+d[1]+'" at '+k.pos);return function(e){for(var t,n=[],r=n,i=[],s=0,o=e.length;s<o;++s)switch((t=e[s])[0]){case"#":case"^":r.push(t),i.push(t),r=t[4]=[];break;case"/":i.pop()[5]=t[2],r=0<i.length?i[i.length-1][4]:n;break;default:r.push(t)}return n}(function(e){for(var t,n,r=[],i=0,s=e.length;i<s;++i)(t=e[i])&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(r.push(t),n=t));return r}(o))}(e,t)),r},e.prototype.render=function(e,t,n){var r=this.parse(e),i=t instanceof s?t:new s(t);return this.renderTokens(r,i,n,e)},e.prototype.renderTokens=function(e,t,n,r){var i,s,o="",a=this;function c(e){return a.render(e,t,n)}for(var u=0,h=e.length;u<h;++u)switch((i=e[u])[0]){case"#":if(!(s=t.lookup(i[1])))continue;if(U(s))for(var l=0,p=s.length;l<p;++l)o+=this.renderTokens(i[4],t.push(s[l]),n,r);else if("object"==typeof s||"string"==typeof s)o+=this.renderTokens(i[4],t.push(s),n,r);else if(f(s)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");null!=(s=s.call(t.view,r.slice(i[3],i[5]),c))&&(o+=s)}else o+=this.renderTokens(i[4],t,n,r);break;case"^":(!(s=t.lookup(i[1]))||U(s)&&0===s.length)&&(o+=this.renderTokens(i[4],t,n,r));break;case">":if(!n)continue;null!=(s=f(n)?n(i[1]):n[i[1]])&&(o+=this.renderTokens(this.parse(s),t,n,s));break;case"&":null!=(s=t.lookup(i[1]))&&(o+=s);break;case"name":null!=(s=t.lookup(i[1]))&&(o+=x.escape(s));break;case"text":o+=i[1]}return o},x.name="mustache.js",x.version="0.8.1",x.tags=["{{","}}"];var o=new e;x.clearCache=function(){return o.clearCache()},x.parse=function(e,t){return o.parse(e,t)},x.render=function(e,t,n){return o.render(e,t,n)},x.to_html=function(e,t,n,r){var i=x.render(e,t,n);if(!f(r))return i;r(i)},x.escape=function(e){return String(e).replace(/[&<>"'\/]/g,function(e){return i[e]})},x.Scanner=S,x.Context=s,x.Writer=e});
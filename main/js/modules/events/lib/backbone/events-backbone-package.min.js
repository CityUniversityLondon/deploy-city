(function(){var t=this,e=t._,o={},r=Array.prototype,i=Object.prototype,n=Function.prototype,s=r.push,a=r.slice,l=r.concat,h=i.toString,u=i.hasOwnProperty,c=r.forEach,d=r.map,f=r.reduce,p=r.reduceRight,g=r.filter,v=r.every,m=r.some,y=r.indexOf,_=r.lastIndexOf,w=Array.isArray,b=Object.keys,x=n.bind,E=function(t){return t instanceof E?t:this instanceof E?void(this._wrapped=t):new E(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=E),exports._=E):t._=E,E.VERSION="1.4.4";var C=E.each=E.forEach=function(t,e,i){if(null!=t)if(c&&t.forEach===c)t.forEach(e,i);else if(t.length===+t.length){for(var n=0,r=t.length;n<r;n++)if(e.call(i,t[n],n,t)===o)return}else for(var s in t)if(E.has(t,s)&&e.call(i,t[s],s,t)===o)return};E.map=E.collect=function(t,n,r){var s=[];return null==t?s:d&&t.map===d?t.map(n,r):(C(t,function(t,e,i){s.push(n.call(r,t,e,i))}),s)};var M="Reduce of empty array with no initial value";E.reduce=E.foldl=E.inject=function(t,n,r,s){var o=2<arguments.length;if(null==t&&(t=[]),f&&t.reduce===f)return s&&(n=E.bind(n,s)),o?t.reduce(n,r):t.reduce(n);if(C(t,function(t,e,i){o?r=n.call(s,r,t,e,i):(r=t,o=!0)}),!o)throw new TypeError(M);return r},E.reduceRight=E.foldr=function(n,r,s,o){var a=2<arguments.length;if(null==n&&(n=[]),p&&n.reduceRight===p)return o&&(r=E.bind(r,o)),a?n.reduceRight(r,s):n.reduceRight(r);var l=n.length;if(l!==+l){var u=E.keys(n);l=u.length}if(C(n,function(t,e,i){e=u?u[--l]:--l,a?s=r.call(o,s,n[e],e,i):(s=n[e],a=!0)}),!a)throw new TypeError(M);return s},E.find=E.detect=function(t,n,r){var s;return P(t,function(t,e,i){if(n.call(r,t,e,i))return s=t,!0}),s},E.filter=E.select=function(t,n,r){var s=[];return null==t?s:g&&t.filter===g?t.filter(n,r):(C(t,function(t,e,i){n.call(r,t,e,i)&&s.push(t)}),s)},E.reject=function(t,n,r){return E.filter(t,function(t,e,i){return!n.call(r,t,e,i)},r)},E.every=E.all=function(t,n,r){n||(n=E.identity);var s=!0;return null==t?s:v&&t.every===v?t.every(n,r):(C(t,function(t,e,i){if(!(s=s&&n.call(r,t,e,i)))return o}),!!s)};var P=E.some=E.any=function(t,n,r){n||(n=E.identity);var s=!1;return null==t?s:m&&t.some===m?t.some(n,r):(C(t,function(t,e,i){if(s||(s=n.call(r,t,e,i)))return o}),!!s)};E.contains=E.include=function(t,e){return null!=t&&(y&&t.indexOf===y?-1!=t.indexOf(e):P(t,function(t){return t===e}))},E.invoke=function(t,e){var i=a.call(arguments,2),n=E.isFunction(e);return E.map(t,function(t){return(n?e:t[e]).apply(t,i)})},E.pluck=function(t,e){return E.map(t,function(t){return t[e]})},E.where=function(t,i,e){return E.isEmpty(i)?e?void 0:[]:E[e?"find":"filter"](t,function(t){for(var e in i)if(i[e]!==t[e])return!1;return!0})},E.findWhere=function(t,e){return E.where(t,e,!0)},E.max=function(t,r,s){if(!r&&E.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!r&&E.isEmpty(t))return-1/0;var o={computed:-1/0,value:-1/0};return C(t,function(t,e,i){var n=r?r.call(s,t,e,i):t;n>=o.computed&&(o={value:t,computed:n})}),o.value},E.min=function(t,r,s){if(!r&&E.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!r&&E.isEmpty(t))return 1/0;var o={computed:1/0,value:1/0};return C(t,function(t,e,i){var n=r?r.call(s,t,e,i):t;n<o.computed&&(o={value:t,computed:n})}),o.value},E.shuffle=function(t){var e,i=0,n=[];return C(t,function(t){e=E.random(i++),n[i-1]=n[e],n[e]=t}),n};var R=function(e){return E.isFunction(e)?e:function(t){return t[e]}};E.sortBy=function(t,e,n){var r=R(e);return E.pluck(E.map(t,function(t,e,i){return{value:t,index:e,criteria:r.call(n,t,e,i)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(n<i||void 0===i)return 1;if(i<n||void 0===n)return-1}return t.index<e.index?-1:1}),"value")};var I=function(n,t,r,s){var o={},a=R(null==t?E.identity:t);return C(n,function(t,e){var i=a.call(r,t,e,n);s(o,i,t)}),o};E.groupBy=function(t,e,i){return I(t,e,i,function(t,e,i){(E.has(t,e)?t[e]:t[e]=[]).push(i)})},E.countBy=function(t,e,i){return I(t,e,i,function(t,e){E.has(t,e)||(t[e]=0),t[e]++})},E.sortedIndex=function(t,e,i,n){for(var r=(i=null==i?E.identity:R(i)).call(n,e),s=0,o=t.length;s<o;){var a=s+o>>>1;i.call(n,t[a])<r?s=1+a:o=a}return s},E.toArray=function(t){return t?E.isArray(t)?a.call(t):t.length===+t.length?E.map(t,E.identity):E.values(t):[]},E.size=function(t){return null==t?0:t.length===+t.length?t.length:E.keys(t).length},E.first=E.head=E.take=function(t,e,i){if(null!=t)return null==e||i?t[0]:a.call(t,0,e)},E.initial=function(t,e,i){return a.call(t,0,t.length-(null==e||i?1:e))},E.last=function(t,e,i){if(null!=t)return null==e||i?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},E.rest=E.tail=E.drop=function(t,e,i){return a.call(t,null==e||i?1:e)},E.compact=function(t){return E.filter(t,E.identity)};var F=function(t,e,i){return C(t,function(t){E.isArray(t)?e?s.apply(i,t):F(t,e,i):i.push(t)}),i};E.flatten=function(t,e){return F(t,e,[])},E.without=function(t){return E.difference(t,a.call(arguments,1))},E.uniq=E.unique=function(i,n,t,e){E.isFunction(n)&&(e=t,t=n,n=!1);var r=t?E.map(i,t,e):i,s=[],o=[];return C(r,function(t,e){(n?e&&o[o.length-1]===t:E.contains(o,t))||(o.push(t),s.push(i[e]))}),s},E.union=function(){return E.uniq(l.apply(r,arguments))},E.intersection=function(t){var i=a.call(arguments,1);return E.filter(E.uniq(t),function(e){return E.every(i,function(t){return 0<=E.indexOf(t,e)})})},E.difference=function(t){var e=l.apply(r,a.call(arguments,1));return E.filter(t,function(t){return!E.contains(e,t)})},E.zip=function(){for(var t=a.call(arguments),e=E.max(E.pluck(t,"length")),i=new Array(e),n=0;n<e;n++)i[n]=E.pluck(t,""+n);return i},E.unzip=function(t){var e=E.max(E.pluck(t,"length"));return E.times(e,E.partial(E.pluck,t))},E.object=function(t,e){if(null==t)return{};for(var i={},n=0,r=t.length;n<r;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},E.indexOf=function(t,e,i){if(null==t)return-1;var n=0,r=t.length;if(i){if("number"!=typeof i)return t[n=E.sortedIndex(t,e)]===e?n:-1;n=i<0?Math.max(0,r+i):i}if(y&&t.indexOf===y)return t.indexOf(e,i);for(;n<r;n++)if(t[n]===e)return n;return-1},E.lastIndexOf=function(t,e,i){if(null==t)return-1;var n=null!=i;if(_&&t.lastIndexOf===_)return n?t.lastIndexOf(e,i):t.lastIndexOf(e);for(var r=n?i:t.length;r--;)if(t[r]===e)return r;return-1},E.range=function(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=i||1;for(var n=Math.max(Math.ceil((e-t)/i),0),r=0,s=new Array(n);r<n;)s[r++]=t,t+=i;return s};var V=function(){};E.bind=function(i,n){var r,s;if(i.bind===x&&x)return x.apply(i,a.call(arguments,1));if(!E.isFunction(i))throw new TypeError;return r=a.call(arguments,2),s=function(){if(!(this instanceof s))return i.apply(n,r.concat(a.call(arguments)));V.prototype=i.prototype;var t=new V;V.prototype=null;var e=i.apply(t,r.concat(a.call(arguments)));return Object(e)===e?e:t}},E.partial=function(t){var e=a.call(arguments,1);return function(){return t.apply(this,e.concat(a.call(arguments)))}},E.bindAll=function(e){var t=a.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return C(t,function(t){e[t]=E.bind(e[t],e)}),e},E.memoize=function(e,i){var n={};return i||(i=E.identity),function(){var t=i.apply(this,arguments);return E.has(n,t)?n[t]:n[t]=e.apply(this,arguments)}},E.delay=function(t,e){var i=a.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},E.defer=function(t){return E.delay.apply(E,[t,1].concat(a.call(arguments,1)))},E.throttle=function(i,n,r){var s,o,a,l,u=0,c=function(){u=new Date,a=null,l=i.apply(s,o)};return function(){var t=new Date;u||!1!==r||(u=t);var e=n-(t-u);return s=this,o=arguments,e<=0?(clearTimeout(a),a=null,u=t,l=i.apply(s,o)):a||(a=setTimeout(c,e)),l}},E.debounce=function(n,r,s){var o,a;return function(){var t=this,e=arguments,i=s&&!o;return clearTimeout(o),o=setTimeout(function(){o=null,s||(a=n.apply(t,e))},r),i&&(a=n.apply(t,e)),a}},E.once=function(t){var e,i=!1;return function(){return i||(i=!0,e=t.apply(this,arguments),t=null),e}},E.wrap=function(e,i){return function(){var t=[e];return s.apply(t,arguments),i.apply(this,t)}},E.compose=function(){var i=arguments;return function(){for(var t=arguments,e=i.length-1;0<=e;e--)t=[i[e].apply(this,t)];return t[0]}},E.after=function(t,e){return t<=0?e():function(){if(--t<1)return e.apply(this,arguments)}},E.keys=b||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var i in t)E.has(t,i)&&e.push(i);return e},E.values=function(t){var e=[];for(var i in t)E.has(t,i)&&e.push(t[i]);return e},E.pairs=function(t){var e=[];for(var i in t)E.has(t,i)&&e.push([i,t[i]]);return e},E.invert=function(t){var e={};for(var i in t)E.has(t,i)&&(e[t[i]]=i);return e},E.functions=E.methods=function(t){var e=[];for(var i in t)E.isFunction(t[i])&&e.push(i);return e.sort()},E.extend=function(i){return C(a.call(arguments,1),function(t){if(t)for(var e in t)i[e]=t[e]}),i},E.pick=function(e){var i={},t=l.apply(r,a.call(arguments,1));return C(t,function(t){t in e&&(i[t]=e[t])}),i},E.omit=function(t){var e={},i=l.apply(r,a.call(arguments,1));for(var n in t)E.contains(i,n)||(e[n]=t[n]);return e},E.defaults=function(i){return C(a.call(arguments,1),function(t){if(t)for(var e in t)void 0===i[e]&&(i[e]=t[e])}),i},E.clone=function(t){return E.isObject(t)?E.isArray(t)?t.slice():E.extend({},t):t},E.tap=function(t,e){return e(t),t};var T=function(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof E&&(t=t._wrapped),e instanceof E&&(e=e._wrapped);var r=h.call(t);if(r!=h.call(e))return!1;switch(r){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var s=i.length;s--;)if(i[s]==t)return n[s]==e;i.push(t),n.push(e);var o=0,a=!0;if("[object Array]"==r){if(a=(o=t.length)==e.length)for(;o--&&(a=T(t[o],e[o],i,n)););}else{var l=t.constructor,u=e.constructor;if(l!==u&&!(E.isFunction(l)&&l instanceof l&&E.isFunction(u)&&u instanceof u))return!1;for(var c in t)if(E.has(t,c)&&(o++,!(a=E.has(e,c)&&T(t[c],e[c],i,n))))break;if(a){for(c in e)if(E.has(e,c)&&!o--)break;a=!o}}return i.pop(),n.pop(),a};E.isEqual=function(t,e){return T(t,e,[],[])},E.isEmpty=function(t){if(null==t)return!0;if(E.isArray(t)||E.isString(t))return 0===t.length;for(var e in t)if(E.has(t,e))return!1;return!0},E.isElement=function(t){return!(!t||1!==t.nodeType)},E.isArray=w||function(t){return"[object Array]"==h.call(t)},E.isObject=function(t){return t===Object(t)},C(["Arguments","Function","String","Number","Date","RegExp"],function(e){E["is"+e]=function(t){return h.call(t)=="[object "+e+"]"}}),E.isArguments(arguments)||(E.isArguments=function(t){return!(!t||!E.has(t,"callee"))}),"function"!=typeof/./&&(E.isFunction=function(t){return"function"==typeof t}),E.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},E.isNaN=function(t){return E.isNumber(t)&&t!=+t},E.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"==h.call(t)},E.isNull=function(t){return null===t},E.isUndefined=function(t){return void 0===t},E.has=function(t,e){return u.call(t,e)},E.noConflict=function(){return t._=e,this},E.identity=function(t){return t},E.times=function(t,e,i){for(var n=Array(Math.max(0,t)),r=0;r<t;r++)n[r]=e.call(i,r);return n},E.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var k={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};k.unescape=E.invert(k.escape);var A={escape:new RegExp("["+E.keys(k.escape).join("")+"]","g"),unescape:new RegExp("("+E.keys(k.unescape).join("|")+")","g")};E.each(["escape","unescape"],function(e){E[e]=function(t){return null==t?"":(""+t).replace(A[e],function(t){return k[e][t]})}}),E.result=function(t,e){if(null!=t){var i=t[e];return E.isFunction(i)?i.call(t):i}},E.mixin=function(i){C(E.functions(i),function(t){var e=E[t]=i[t];E.prototype[t]=function(){var t=[this._wrapped];return s.apply(t,arguments),z.call(this,e.apply(E,t))}})};var S=0;E.uniqueId=function(t){var e=++S+"";return t?t+e:e},E.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var N=/(.)^/,O={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;E.template=function(s,t,e){var i;e=E.defaults({},e,E.templateSettings);var n=new RegExp([(e.escape||N).source,(e.interpolate||N).source,(e.evaluate||N).source].join("|")+"|$","g"),o=0,a="__p+='";s.replace(n,function(t,e,i,n,r){return a+=s.slice(o,r).replace(j,function(t){return"\\"+O[t]}),e&&(a+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'"),i&&(a+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),n&&(a+="';\n"+n+"\n__p+='"),o=r+t.length,t}),a+="';\n",e.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{i=new Function(e.variable||"obj","_",a)}catch(t){throw t.source=a,t}if(t)return i(t,E);var r=function(t){return i.call(this,t,E)};return r.source="function("+(e.variable||"obj")+"){\n"+a+"}",r},E.chain=function(t){return E(t).chain()};var z=function(t){return this._chain?E(t).chain():t};E.mixin(E),C(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var i=r[e];E.prototype[e]=function(){var t=this._wrapped;return i.apply(t,arguments),"shift"!=e&&"splice"!=e||0!==t.length||delete t[0],z.call(this,t)}}),C(["concat","join","slice"],function(t){var e=r[t];E.prototype[t]=function(){return z.call(this,e.apply(this._wrapped,arguments))}}),E.extend(E.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this),function(){var a,t=this,e=t.Backbone,i=[],y=i.push,r=i.slice,_=i.splice;(a="undefined"!=typeof exports?exports:t.Backbone={}).VERSION="1.0.0";var w=t._;w||"undefined"==typeof require||(w=require("underscore")),a.$=t.jQuery||t.Zepto||t.ender||t.$,a.noConflict=function(){return t.Backbone=e,this},a.emulateHTTP=!1,a.emulateJSON=!1;var n=a.Events={on:function(t,e,i){return h(this,"on",t,[e,i])&&e&&(this._events||(this._events={}),(this._events[t]||(this._events[t]=[])).push({callback:e,context:i,ctx:i||this})),this},once:function(t,e,i){if(!h(this,"once",t,[e,i])||!e)return this;var n=this,r=w.once(function(){n.off(t,r),e.apply(this,arguments)});return r._callback=e,this.on(t,r,i)},off:function(t,e,i){var n,r,s,o,a,l,u,c;if(!this._events||!h(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events={},this;for(a=0,l=(o=t?[t]:w.keys(this._events)).length;a<l;a++)if(t=o[a],s=this._events[t]){if(this._events[t]=n=[],e||i)for(u=0,c=s.length;u<c;u++)r=s[u],(e&&e!==r.callback&&e!==r.callback._callback||i&&i!==r.context)&&n.push(r);n.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=r.call(arguments,1);if(!h(this,"trigger",t,e))return this;var i=this._events[t],n=this._events.all;return i&&s(i,e),n&&s(n,arguments),this},stopListening:function(t,e,i){var n=this._listeners;if(!n)return this;var r=!e&&!i;for(var s in"object"==typeof e&&(i=this),t&&((n={})[t._listenerId]=t),n)n[s].off(e,i,this),r&&delete this._listeners[s];return this}},l=/\s+/,h=function(t,e,i,n){if(!i)return!0;if("object"==typeof i){for(var r in i)t[e].apply(t,[r,i[r]].concat(n));return!1}if(l.test(i)){for(var s=i.split(l),o=0,a=s.length;o<a;o++)t[e].apply(t,[s[o]].concat(n));return!1}return!0},s=function(t,e){var i,n=-1,r=t.length,s=e[0],o=e[1],a=e[2];switch(e.length){case 0:for(;++n<r;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<r;)(i=t[n]).callback.call(i.ctx,s);return;case 2:for(;++n<r;)(i=t[n]).callback.call(i.ctx,s,o);return;case 3:for(;++n<r;)(i=t[n]).callback.call(i.ctx,s,o,a);return;default:for(;++n<r;)(i=t[n]).callback.apply(i.ctx,e)}};w.each({listenTo:"on",listenToOnce:"once"},function(r,t){n[t]=function(t,e,i){var n=this._listeners||(this._listeners={});return"object"==typeof e&&(i=this),(n[t._listenerId||(t._listenerId=w.uniqueId("l"))]=t)[r](e,i,this),this}}),n.bind=n.on,n.unbind=n.off,w.extend(a,n);var o=a.Model=function(t,e){var i,n=t||{};e||(e={}),this.cid=w.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{}),e._attrs=n,(i=w.result(this,"defaults"))&&(n=w.defaults({},n,i)),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};w.extend(o.prototype,n,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return w.clone(this.attributes)},sync:function(){return a.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return w.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var n,r,s,o,a,l,u,c;if(null==t)return this;if("object"==typeof t?(r=t,i=e):(r={})[t]=e,i||(i={}),!this._validate(r,i))return!1;for(n in s=i.unset,a=i.silent,o=[],l=this._changing,this._changing=!0,l||(this._previousAttributes=w.clone(this.attributes),this.changed={}),c=this.attributes,u=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]),r)e=r[n],w.isEqual(c[n],e)||o.push(n),w.isEqual(u[n],e)?delete this.changed[n]:this.changed[n]=e,s?delete c[n]:c[n]=e;if(!a){o.length&&(this._pending=!0);for(var h=0,d=o.length;h<d;h++)this.trigger("change:"+o[h],this,c[o[h]],i)}if(l)return this;if(!a)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,w.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,w.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!w.isEmpty(this.changed):w.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&w.clone(this.changed);var e,i=!1,n=this._changing?this._previousAttributes:this.attributes;for(var r in t)w.isEqual(n[r],e=t[r])||((i||(i={}))[r]=e);return i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return w.clone(this._previousAttributes)},fetch:function(e){void 0===(e=e?w.clone(e):{}).parse&&(e.parse=!0);var i=this,n=e.success;return e.success=function(t){if(!i.set(i.parse(t,e),e))return!1;n&&n(i,t,e),i.trigger("sync",i,t,e)},T(this,e),this.sync("read",this,e)},save:function(t,e,i){var n,r,s,o=this.attributes;if(null==t||"object"==typeof t?(n=t,i=e):(n={})[t]=e,i=w.extend({validate:!0},i),n&&!i.wait){if(!this.set(n,i))return!1}else if(!this._validate(n,i))return!1;n&&i.wait&&(this.attributes=w.extend({},o,n)),void 0===i.parse&&(i.parse=!0);var a=this,l=i.success;return i.success=function(t){a.attributes=o;var e=a.parse(t,i);if(i.wait&&(e=w.extend(n||{},e)),w.isObject(e)&&!a.set(e,i))return!1;l&&l(a,t,i),a.trigger("sync",a,t,i)},T(this,i),"patch"==(r=this.isNew()?"create":i.patch?"patch":"update")&&(i.attrs=n),s=this.sync(r,this,i),n&&i.wait&&(this.attributes=o),s},destroy:function(e){e=e?w.clone(e):{};var i=this,n=e.success,r=function(){i.trigger("destroy",i,i.collection,e)};if(e.success=function(t){(e.wait||i.isNew())&&r(),n&&n(i,t,e),i.isNew()||i.trigger("sync",i,t,e)},this.isNew())return e.success(),!1;T(this,e);var t=this.sync("delete",this,e);return e.wait||r(),t},url:function(){var t=w.result(this,"urlRoot")||w.result(this.collection,"url")||V();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},w.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=w.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return!i||(this.trigger("invalid",this,i,w.extend(e||{},{validationError:i})),!1)}});w.each(["keys","values","pairs","invert","pick","omit"],function(e){o.prototype[e]=function(){var t=r.call(arguments);return t.unshift(this.attributes),w[e].apply(w,t)}});var u=a.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,w.extend({silent:!0},e))},b={add:!0,remove:!0,merge:!0},c={add:!0,merge:!1,remove:!1};w.extend(u.prototype,n,{model:o,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return a.sync.apply(this,arguments)},add:function(t,e){return this.set(t,w.defaults(e||{},c))},remove:function(t,e){var i,n,r,s;for(e||(e={}),i=0,n=(t=w.isArray(t)?t.slice():[t]).length;i<n;i++)(s=this.get(t[i]))&&(delete this._byId[s.id],delete this._byId[s.cid],r=this.indexOf(s),this.models.splice(r,1),this.length--,e.silent||(e.index=r,s.trigger("remove",s,this,e)),this._removeReference(s));return this},set:function(t,e){var i,n,r,s,o,a;(e=w.defaults(e||{},b)).parse&&(t=this.parse(t,e)),w.isArray(t)||(t=t?[t]:[]);var l=e.at,u=this.comparator&&null==l&&!1!==e.sort,c=w.isString(this.comparator)?this.comparator:null,h=[],d=[],f={},p=e.add,g=e.merge,v=e.remove,m=!(u||!p||!v)&&[];for(i=0,n=t.length;i<n;i++)(r=this._prepareModel(s=t[i],e))&&((o=this.get(r))?(v&&(f[o.cid]=!0),g&&(s=s===r?r.attributes:e._attrs,o.set(s,e),u&&!a&&o.hasChanged(c)&&(a=!0))):p&&(h.push(r),r.on("all",this._onModelEvent,this),null!=(this._byId[r.cid]=r).id&&(this._byId[r.id]=r)),m&&m.push(o||r));if(v){for(i=0,n=this.length;i<n;++i)f[(r=this.models[i]).cid]||d.push(r);d.length&&this.remove(d,e)}if((h.length||m&&m.length)&&(u&&(a=!0),this.length+=h.length,null!=l?_.apply(this.models,[l,0].concat(h)):(m&&(this.models.length=0),y.apply(this.models,m||h))),a&&this.sort({silent:!0}),e.silent)return this;for(i=0,n=h.length;i<n;i++)(r=h[i]).trigger("add",r,this,e);return(a||m&&m.length)&&this.trigger("sort",this,e),this},reset:function(t,e){e||(e={});for(var i=0,n=this.models.length;i<n;i++)this._removeReference(this.models[i]);return e.previousModels=this.models,this._reset(),this.add(t,w.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),this},push:function(t,e){return t=this._prepareModel(t,e),this.add(t,w.extend({at:this.length},e)),t},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return t=this._prepareModel(t,e),this.add(t,w.extend({at:0},e)),t},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return r.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[null!=t.id?t.id:t.cid||t]},at:function(t){return this.models[t]},where:function(i,t){return w.isEmpty(i)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var e in i)if(i[e]!==t.get(e))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),w.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(w.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},sortedIndex:function(t,e,i){e||(e=this.comparator);var n=w.isFunction(e)?e:function(t){return t.get(e)};return w.sortedIndex(this.models,t,n,i)},pluck:function(t){return w.invoke(this.models,"get",t)},fetch:function(i){void 0===(i=i?w.clone(i):{}).parse&&(i.parse=!0);var n=i.success,r=this;return i.success=function(t){var e=i.reset?"reset":"set";r[e](t,i),n&&n(r,t,i),r.trigger("sync",r,t,i)},T(this,i),this.sync("read",this,i)},create:function(e,i){if(i=i?w.clone(i):{},!(e=this._prepareModel(e,i)))return!1;i.wait||this.add(e,i);var n=this,r=i.success;return i.success=function(t){i.wait&&n.add(e,i),r&&r(e,t,i)},e.save(null,i),e},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof o)return t.collection||(t.collection=this),t;e||(e={});var i=new(e.collection=this).model(t,e);return i._validate(t,e)?i:(this.trigger("invalid",this,t,e),!1)},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,n),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});w.each(["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"],function(e){u.prototype[e]=function(){var t=r.call(arguments);return t.unshift(this.models),w[e].apply(w,t)}});w.each(["groupBy","countBy","sortBy"],function(n){u.prototype[n]=function(e,t){var i=w.isFunction(e)?e:function(t){return t.get(e)};return w[n](this.models,i,t)}});var d=a.View=function(t){this.cid=w.uniqueId("view"),t||(t={}),w.extend(this,w.pick(t,p)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},f=/^(\S+)\s*(.*)$/,p=["model","collection","el","id","attributes","className","tagName","events"];w.extend(d.prototype,n,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,e){return this.$el&&this.undelegateEvents(),this.$el=t instanceof a.$?t:a.$(t),this.el=this.$el[0],!1!==e&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=w.result(this,"events")))return this;for(var e in this.undelegateEvents(),t){var i=t[e];if(w.isFunction(i)||(i=this[t[e]]),i){var n=e.match(f),r=n[1],s=n[2];i=w.bind(i,this),r+=".delegateEvents"+this.cid,""===s?this.$el.on(r,i):this.$el.on(r,s,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(w.result(this,"el"),!1);else{var t=w.extend({},w.result(this,"attributes"));this.id&&(t.id=w.result(this,"id")),this.className&&(t.class=w.result(this,"className"));var e=a.$("<"+w.result(this,"tagName")+">").attr(t);this.setElement(e,!1)}}}),a.sync=function(t,e,i){var n=g[t];w.defaults(i||(i={}),{emulateHTTP:a.emulateHTTP,emulateJSON:a.emulateJSON});var r={type:n,dataType:"json"};if(i.url||(r.url=w.result(e,"url")||V()),null!=i.data||!e||"create"!==t&&"update"!==t&&"patch"!==t||(r.contentType="application/json",r.data=JSON.stringify(i.attrs||e.toJSON(i))),i.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),i.emulateHTTP&&("PUT"===n||"DELETE"===n||"PATCH"===n)){r.type="POST",i.emulateJSON&&(r.data._method=n);var s=i.beforeSend;i.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",n),s)return s.apply(this,arguments)}}"GET"===r.type||i.emulateJSON||(r.processData=!1),"PATCH"!==r.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(r.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var o=i.xhr=a.ajax(w.extend(r,i));return e.trigger("request",e,o,i),o};var g={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};a.ajax=function(){return a.$.ajax.apply(a.$,arguments)};var v=a.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},m=/\((.*?)\)/g,x=/(\(\?)?:\w+/g,E=/\*\w+/g,C=/[\-{}\[\]+?.,\\\^$|#\s]/g;w.extend(v.prototype,n,{initialize:function(){},route:function(i,n,r){w.isRegExp(i)||(i=this._routeToRegExp(i)),w.isFunction(n)&&(r=n,n=""),r||(r=this[n]);var s=this;return a.history.route(i,function(t){var e=s._extractParameters(i,t);r&&r.apply(s,e),s.trigger.apply(s,["route:"+n].concat(e)),s.trigger("route",n,e),a.history.trigger("route",s,n,e)}),this},navigate:function(t,e){return a.history.navigate(t,e),this},_bindRoutes:function(){if(this.routes){this.routes=w.result(this,"routes");for(var t,e=w.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(C,"\\$&").replace(m,"(?:$1)?").replace(x,function(t,e){return e?t:"([^/]+)"}).replace(E,"(.*?)"),new RegExp("^"+t+"$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return w.map(i,function(t){return t?decodeURIComponent(t):null})}});var M=a.History=function(){this.handlers=[],w.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},P=/^[#\/]|\s+$/g,R=/^\/+|\/+$/g,I=/msie [\w.]+/,F=/\/$/;M.started=!1,w.extend(M.prototype,n,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var i=this.root.replace(F,"");t.indexOf(i)||(t=t.substr(i.length))}else t=this.getHash();return t.replace(P,"")},start:function(t){if(M.started)throw new Error("Backbone.history has already been started");M.started=!0,this.options=w.extend({},{root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var e=this.getFragment(),i=document.documentMode,n=I.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);this.root=("/"+this.root+"/").replace(R,"/"),n&&this._wantsHashChange&&(this.iframe=a.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(e)),this._hasPushState?a.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!n?a.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=e;var r=this.location,s=r.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&s&&r.hash&&(this.fragment=this.getHash().replace(P,""),this.history.replaceState({},document.title,this.root+this.fragment+r.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){a.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),M.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(t){var e=this.fragment=this.getFragment(t);return w.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(t,e){if(!M.started)return!1;if(e&&!0!==e||(e={trigger:e}),t=this.getFragment(t||""),this.fragment!==t){this.fragment=t;var i=this.root+t;if(this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),a.history=new M;o.extend=u.extend=v.extend=d.extend=M.extend=function(t,e){var i,n=this;i=t&&w.has(t,"constructor")?t.constructor:function(){return n.apply(this,arguments)},w.extend(i,n,e);var r=function(){this.constructor=i};return r.prototype=n.prototype,i.prototype=new r,t&&w.extend(i.prototype,t),i.__super__=n.prototype,i};var V=function(){throw new Error('A "url" property or function must be specified')},T=function(e,i){var n=i.error;i.error=function(t){n&&n(e,t,i),e.trigger("error",e,t,i)}}}.call(this),Backbone.ChildViewContainer=function(t,r){var i=function(t){this._views={},this._indexByModel={},this._indexByCollection={},this._indexByCustom={},this._updateLength(),this._addInitialViews(t)};r.extend(i.prototype,{add:function(t,e){var i=t.cid;(this._views[i]=t).model&&(this._indexByModel[t.model.cid]=i),t.collection&&(this._indexByCollection[t.collection.cid]=i),e&&(this._indexByCustom[e]=i),this._updateLength()},findByModel:function(t){var e=this._indexByModel[t.cid];return this.findByCid(e)},findByCollection:function(t){var e=this._indexByCollection[t.cid];return this.findByCid(e)},findByCustom:function(t){var e=this._indexByCustom[t];return this.findByCid(e)},findByIndex:function(t){return r.values(this._views)[t]},findByCid:function(t){return this._views[t]},remove:function(t){var e,i=t.cid;for(var n in t.model&&delete this._indexByModel[t.model.cid],t.collection&&delete this._indexByCollection[t.collection.cid],this._indexByCustom)if(this._indexByCustom.hasOwnProperty(n)&&this._indexByCustom[n]===i){e=n;break}e&&delete this._indexByCustom[e],delete this._views[i],this._updateLength()},call:function(t,e){e=Array.prototype.slice.call(arguments,1),this.apply(t,e)},apply:function(i,n){n=n||[],r.each(this._views,function(t,e){r.isFunction(t[i])&&t[i].apply(t,n)})},_updateLength:function(){this.length=r.size(this._views)},_addInitialViews:function(t){if(t){var e,i,n=t.length;for(i=0;i<n;i++)e=t[i],this.add(e)}}});return r.each(["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"],function(e){i.prototype[e]=function(){var t=[r.values(this._views)].concat(r.toArray(arguments));return r[e].apply(r,t)}}),i}(Backbone,_),Backbone.Wreqr=function(t,e,r){"use strict";var i,n,s,o,a,l,u,c,h={};return h.Handlers=(n=r,(s=function(t){this.options=t,this._wreqrHandlers={},n.isFunction(this.initialize)&&this.initialize(t)}).extend=(i=t).Model.extend,n.extend(s.prototype,i.Events,{setHandlers:function(t){n.each(t,function(t,e){var i=null;n.isObject(t)&&!n.isFunction(t)&&(i=t.context,t=t.callback),this.setHandler(e,t,i)},this)},setHandler:function(t,e,i){var n={callback:e,context:i};this._wreqrHandlers[t]=n,this.trigger("handler:add",t,e,i)},hasHandler:function(t){return!!this._wreqrHandlers[t]},getHandler:function(t){var e=this._wreqrHandlers[t];if(!e)throw new Error("Handler not found for '"+t+"'");return function(){var t=Array.prototype.slice.apply(arguments);return e.callback.apply(e.context,t)}},removeHandler:function(t){delete this._wreqrHandlers[t]},removeAllHandlers:function(){this._wreqrHandlers={}}}),s),h.CommandStorage=(o=function(t){this.options=t,this._commands={},r.isFunction(this.initialize)&&this.initialize(t)},r.extend(o.prototype,t.Events,{getCommands:function(t){var e=this._commands[t];return e||(e={command:t,instances:[]},this._commands[t]=e),e},addCommand:function(t,e){this.getCommands(t).instances.push(e)},clearCommands:function(t){this.getCommands(t).instances=[]}}),o),h.Commands=(a=h).Handlers.extend({storageType:a.CommandStorage,constructor:function(t){this.options=t||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this);var e=Array.prototype.slice.call(arguments);a.Handlers.prototype.constructor.apply(this,e)},execute:function(t,e){t=arguments[0],e=Array.prototype.slice.call(arguments,1),this.hasHandler(t)?this.getHandler(t).apply(this,e):this.storage.addCommand(t,e)},_executeCommands:function(t,e,i){var n=this.storage.getCommands(t);r.each(n.instances,function(t){e.apply(i,t)}),this.storage.clearCommands(t)},_initializeStorage:function(t){var e,i=t.storageType||this.storageType;e=r.isFunction(i)?new i:i,this.storage=e}}),h.RequestResponse=h.Handlers.extend({request:function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);return this.getHandler(t).apply(this,e)}}),h.EventAggregator=(u=r,(c=function(){}).extend=(l=t).Model.extend,u.extend(c.prototype,l.Events),c),h}(Backbone,Backbone.Marionette,_);var Marionette=function(t,n,u){"use strict";var o={};(n.Marionette=o).$=n.$;var a,i,e=Array.prototype.slice;function l(t){return e.call(t)}function c(t,e){var i=new Error(t);throw i.name=e||"Error",i}return o.extend=n.Model.extend,o.getOption=function(t,e){if(t&&e)return t.options&&e in t.options&&void 0!==t.options[e]?t.options[e]:t[e]},o.triggerMethod=function(){var i=/(^|:)(\w)/gi;function n(t,e,i){return i.toUpperCase()}return function(t){var e=this["on"+t.replace(i,n)];if(this.trigger.apply(this,arguments),u.isFunction(e))return e.apply(this,u.tail(arguments))}}(),o.MonitorDOMRefresh=function(){function e(t){t._isShown&&t._isRendered&&u.isFunction(t.triggerMethod)&&t.triggerMethod("dom:refresh")}return function(t){t.listenTo(t,"show",function(){!function(t){t._isShown=!0,e(t)}(t)}),t.listenTo(t,"render",function(){!function(t){t._isRendered=!0,e(t)}(t)})}}(),function(t){function n(i,n,r,t){var e=t.split(/\s+/);u.each(e,function(t){var e=i[t];e||c("Method '"+t+"' was configured as an event handler, but does not exist."),i.listenTo(n,r,e,i)})}function r(t,e,i,n){t.listenTo(e,i,n,t)}function s(i,n,r,t){var e=t.split(/\s+/);u.each(e,function(t){var e=i[e];i.stopListening(n,r,e,i)})}function o(t,e,i,n){t.stopListening(e,i,n,t)}function a(i,n,t,r,s){n&&t&&(u.isFunction(t)&&(t=t.call(i)),u.each(t,function(t,e){u.isFunction(t)?r(i,n,e,t):s(i,n,e,t)}))}t.bindEntityEvents=function(t,e,i){a(t,e,i,r,n)},t.unbindEntityEvents=function(t,e,i){a(t,e,i,o,s)}}(o),o.Callbacks=function(){this._deferred=o.$.Deferred(),this._callbacks=[]},u.extend(o.Callbacks.prototype,{add:function(i,n){this._callbacks.push({cb:i,ctx:n}),this._deferred.done(function(t,e){n&&(t=n),i.call(t,e)})},run:function(t,e){this._deferred.resolve(e,t)},reset:function(){var t=this._callbacks;this._deferred=o.$.Deferred(),this._callbacks=[],u.each(t,function(t){this.add(t.cb,t.ctx)},this)}}),o.Controller=function(t){this.triggerMethod=o.triggerMethod,this.options=t||{},u.isFunction(this.initialize)&&this.initialize(this.options)},o.Controller.extend=o.extend,u.extend(o.Controller.prototype,n.Events,{close:function(){this.stopListening(),this.triggerMethod("close"),this.unbind()}}),o.Region=function(t){if(this.options=t||{},this.el=o.getOption(this,"el"),!this.el){var e=new Error("An 'el' must be specified for a region.");throw e.name="NoElError",e}if(this.initialize){var i=Array.prototype.slice.apply(arguments);this.initialize.apply(this,i)}},u.extend(o.Region,{buildRegion:function(i,t){var e,n,r="string"==typeof i,s="string"==typeof i.selector,o=void 0===i.regionType,a="function"==typeof i;if(!a&&!r&&!s)throw new Error("Region must be specified as a Region type, a selector string or an object with selector property");r&&(e=i),i.selector&&(e=i.selector),a&&(n=i),!a&&o&&(n=t),i.regionType&&(n=i.regionType);var l=new n({el:e});return i.parentEl&&(l.getEl=function(t){var e=i.parentEl;return u.isFunction(e)&&(e=e()),e.find(t)}),l}}),u.extend(o.Region.prototype,n.Events,{show:function(t){this.ensureEl(),t!==this.currentView?(this.close(),t.render(),this.open(t)):t.render(),o.triggerMethod.call(t,"show"),o.triggerMethod.call(this,"show",t),this.currentView=t},ensureEl:function(){this.$el&&0!==this.$el.length||(this.$el=this.getEl(this.el))},getEl:function(t){return o.$(t)},open:function(t){this.$el.empty().append(t.el)},close:function(){var t=this.currentView;t&&!t.isClosed&&(t.close?t.close():t.remove&&t.remove(),o.triggerMethod.call(this,"close"),delete this.currentView)},attachView:function(t){this.currentView=t},reset:function(){this.close(),delete this.$el}}),o.Region.extend=o.extend,o.RegionManager=(i=(a=o).Controller.extend({constructor:function(t){this._regions={},a.Controller.prototype.constructor.call(this,t)},addRegions:function(t,n){var r={};return u.each(t,function(t,e){"string"==typeof t&&(t={selector:t}),t.selector&&(t=u.defaults({},t,n));var i=this.addRegion(e,t);r[e]=i},this),r},addRegion:function(t,e){var i,n=u.isObject(e),r=u.isString(e),s=!!e.selector;return i=r||n&&s?a.Region.buildRegion(e,a.Region):u.isFunction(e)?a.Region.buildRegion(e,a.Region):e,this._store(t,i),this.triggerMethod("region:add",t,i),i},get:function(t){return this._regions[t]},removeRegion:function(t){var e=this._regions[t];this._remove(t,e)},removeRegions:function(){u.each(this._regions,function(t,e){this._remove(e,t)},this)},closeRegions:function(){u.each(this._regions,function(t,e){t.close()},this)},close:function(){this.removeRegions();var t=Array.prototype.slice.call(arguments);a.Controller.prototype.close.apply(this,t)},_store:function(t,e){this._regions[t]=e,this.length=u.size(this._regions)},_remove:function(t,e){e.close(),delete this._regions[t],this.triggerMethod("region:remove",t,e)}}),u.each(["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"],function(e){i.prototype[e]=function(){var t=[u.values(this._regions)].concat(u.toArray(arguments));return u[e].apply(u,t)}}),i),o.TemplateCache=function(t){this.templateId=t},u.extend(o.TemplateCache,{templateCaches:{},get:function(t){var e=this.templateCaches[t];return e||(e=new o.TemplateCache(t),this.templateCaches[t]=e),e.load()},clear:function(){var t,e=l(arguments),i=e.length;if(0<i)for(t=0;t<i;t++)delete this.templateCaches[e[t]];else this.templateCaches={}}}),u.extend(o.TemplateCache.prototype,{load:function(){if(this.compiledTemplate)return this.compiledTemplate;var t=this.loadTemplate(this.templateId);return this.compiledTemplate=this.compileTemplate(t),this.compiledTemplate},loadTemplate:function(t){var e=o.$(t).html();return e&&0!==e.length||c("Could not find template: '"+t+"'","NoTemplateError"),e},compileTemplate:function(t){return u.template(t)}}),o.Renderer={render:function(t,e){return("function"==typeof t?t:o.TemplateCache.get(t))(e)}},o.View=n.View.extend({constructor:function(){u.bindAll(this,"render");var t=Array.prototype.slice.apply(arguments);n.View.prototype.constructor.apply(this,t),o.MonitorDOMRefresh(this),this.listenTo(this,"show",this.onShowCalled,this)},triggerMethod:o.triggerMethod,getTemplate:function(){return o.getOption(this,"template")},mixinTemplateHelpers:function(t){t=t||{};var e=this.templateHelpers;return u.isFunction(e)&&(e=e.call(this)),u.extend(t,e)},configureTriggers:function(){if(this.triggers){var e={},t=u.result(this,"triggers");return u.each(t,function(i,t){e[t]=function(t){t&&t.preventDefault&&t.preventDefault(),t&&t.stopPropagation&&t.stopPropagation();var e={view:this,model:this.model,collection:this.collection};this.triggerMethod(i,e)}},this),e}},delegateEvents:function(t){this._delegateDOMEvents(t),o.bindEntityEvents(this,this.model,o.getOption(this,"modelEvents")),o.bindEntityEvents(this,this.collection,o.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(t){t=t||this.events,u.isFunction(t)&&(t=t.call(this));var e={},i=this.configureTriggers();u.extend(e,t,i),n.View.prototype.delegateEvents.call(this,e)},undelegateEvents:function(){var t=Array.prototype.slice.call(arguments);n.View.prototype.undelegateEvents.apply(this,t),o.unbindEntityEvents(this,this.model,o.getOption(this,"modelEvents")),o.unbindEntityEvents(this,this.collection,o.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){this.isClosed||!1!==this.triggerMethod("before:close")&&(this.isClosed=!0,this.triggerMethod("close"),this.unbindUIElements(),this.remove())},bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var i=u.result(this,"_uiBindings");this.ui={},u.each(u.keys(i),function(t){var e=i[t];this.ui[t]=this.$(e)},this)}},unbindUIElements:function(){this.ui&&(u.each(this.ui,function(t,e){delete this.ui[e]},this),this.ui=this._uiBindings,delete this._uiBindings)}}),o.ItemView=o.View.extend({constructor:function(){o.View.prototype.constructor.apply(this,l(arguments))},serializeData:function(){var t={};return this.model?t=this.model.toJSON():this.collection&&(t={items:this.collection.toJSON()}),t},render:function(){this.isClosed=!1,this.triggerMethod("before:render",this),this.triggerMethod("item:before:render",this);var t=this.serializeData();t=this.mixinTemplateHelpers(t);var e=this.getTemplate(),i=o.Renderer.render(e,t);return this.$el.html(i),this.bindUIElements(),this.triggerMethod("render",this),this.triggerMethod("item:rendered",this),this},close:function(){this.isClosed||(this.triggerMethod("item:before:close"),o.View.prototype.close.apply(this,l(arguments)),this.triggerMethod("item:closed"))}}),o.CollectionView=o.View.extend({itemViewEventPrefix:"itemview",constructor:function(t){this._initChildViewStorage(),o.View.prototype.constructor.apply(this,l(arguments)),this._initialEvents()},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this.render,this))},addChildView:function(t,e,i){this.closeEmptyView();var n=this.getItemView(t),r=this.collection.indexOf(t);this.addItemView(t,n,r)},onShowCalled:function(){this.children.each(function(t){o.triggerMethod.call(t,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this),this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this),this.triggerMethod("collection:rendered",this)},render:function(){return this.isClosed=!1,this.triggerBeforeRender(),this._renderChildren(),this.triggerRendered(),this},_renderChildren:function(){this.closeEmptyView(),this.closeChildren(),this.collection&&0<this.collection.length?this.showCollection():this.showEmptyView()},showCollection:function(){var i;this.collection.each(function(t,e){i=this.getItemView(t),this.addItemView(t,i,e)},this)},showEmptyView:function(){var t=o.getOption(this,"emptyView");if(t&&!this._showingEmptyView){this._showingEmptyView=!0;var e=new n.Model;this.addItemView(e,t,0)}},closeEmptyView:function(){this._showingEmptyView&&(this.closeChildren(),delete this._showingEmptyView)},getItemView:function(t){var e=o.getOption(this,"itemView");return e||c("An `itemView` must be specified","NoItemViewError"),e},addItemView:function(t,e,i){var n=o.getOption(this,"itemViewOptions");u.isFunction(n)&&(n=n.call(this,t,i));var r=this.buildItemView(t,e,n);this.addChildViewEventForwarding(r),this.triggerMethod("before:item:added",r),this.children.add(r),this.renderItemView(r,i),this._isShown&&o.triggerMethod.call(r,"show"),this.triggerMethod("after:item:added",r)},addChildViewEventForwarding:function(e){var i=o.getOption(this,"itemViewEventPrefix");this.listenTo(e,"all",function(){var t=l(arguments);t[0]=i+":"+t[0],t.splice(1,0,e),o.triggerMethod.apply(this,t)},this)},renderItemView:function(t,e){t.render(),this.appendHtml(this,t,e)},buildItemView:function(t,e,i){return new e(u.extend({model:t},i))},removeItemView:function(t){var e=this.children.findByModel(t);this.removeChildView(e),this.checkEmpty()},removeChildView:function(t){t&&(this.stopListening(t),t.close?t.close():t.remove&&t.remove(),this.children.remove(t)),this.triggerMethod("item:removed",t)},checkEmpty:function(){this.collection&&0!==this.collection.length||this.showEmptyView()},appendHtml:function(t,e,i){t.$el.append(e.el)},_initChildViewStorage:function(){this.children=new n.ChildViewContainer},close:function(){this.isClosed||(this.triggerMethod("collection:before:close"),this.closeChildren(),this.triggerMethod("collection:closed"),o.View.prototype.close.apply(this,l(arguments)))},closeChildren:function(){this.children.each(function(t){this.removeChildView(t)},this),this.checkEmpty()}}),o.CompositeView=o.CollectionView.extend({constructor:function(t){o.CollectionView.apply(this,l(arguments)),this.itemView=this.getItemView()},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this._renderChildren,this))},getItemView:function(t){var e=o.getOption(this,"itemView")||this.constructor;return e||c("An `itemView` must be specified","NoItemViewError"),e},serializeData:function(){var t={};return this.model&&(t=this.model.toJSON()),t},render:function(){this.isRendered=!0,this.isClosed=!1,this.resetItemViewContainer(),this.triggerBeforeRender();var t=this.renderModel();return this.$el.html(t),this.bindUIElements(),this.triggerMethod("composite:model:rendered"),this._renderChildren(),this.triggerMethod("composite:rendered"),this.triggerRendered(),this},_renderChildren:function(){this.isRendered&&(o.CollectionView.prototype._renderChildren.call(this),this.triggerMethod("composite:collection:rendered"))},renderModel:function(){var t={};t=this.serializeData(),t=this.mixinTemplateHelpers(t);var e=this.getTemplate();return o.Renderer.render(e,t)},appendHtml:function(t,e){this.getItemViewContainer(t).append(e.el)},getItemViewContainer:function(t){if("$itemViewContainer"in t)return t.$itemViewContainer;var e;if(t.itemViewContainer){var i=u.result(t,"itemViewContainer");(e=t.$(i)).length<=0&&c("The specified `itemViewContainer` was not found: "+t.itemViewContainer,"ItemViewContainerMissingError")}else e=t.$el;return t.$itemViewContainer=e},resetItemViewContainer:function(){this.$itemViewContainer&&delete this.$itemViewContainer}}),o.Layout=o.ItemView.extend({regionType:o.Region,constructor:function(t){t=t||{},this._firstRender=!0,this._initializeRegions(t),o.ItemView.call(this,t)},render:function(){this._firstRender?this._firstRender=!1:this.isClosed?this._initializeRegions():this._reInitializeRegions();var t=Array.prototype.slice.apply(arguments);return o.ItemView.prototype.render.apply(this,t)},close:function(){if(!this.isClosed){this.regionManager.close();var t=Array.prototype.slice.apply(arguments);o.ItemView.prototype.close.apply(this,t)}},addRegion:function(t,e){var i={};return i[t]=e,this.addRegions(i)[t]},addRegions:function(t){return this.regions=u.extend(this.regions||{},t),this._buildRegions(t)},removeRegion:function(t){return this.regionManager.removeRegion(t)},_buildRegions:function(t){var e=this,i={parentEl:function(){return e.$el}};return this.regionManager.addRegions(t,i)},_initializeRegions:function(t){var e;this._initRegionManager(),e=u.isFunction(this.regions)?this.regions(t):this.regions||{},this.addRegions(e)},_reInitializeRegions:function(){this.regionManager.closeRegions(),this.regionManager.each(function(t){t.reset()})},_initRegionManager:function(){this.regionManager=new o.RegionManager,this.listenTo(this.regionManager,"region:add",function(t,e){this[t]=e,this.trigger("region:add",t,e)}),this.listenTo(this.regionManager,"region:remove",function(t,e){delete this[t],this.trigger("region:remove",t,e)})}}),o.AppRouter=n.Router.extend({constructor:function(t){if(n.Router.prototype.constructor.apply(this,l(arguments)),this.options=t,this.appRoutes){var e=o.getOption(this,"controller");this.processAppRoutes(e,this.appRoutes)}},processAppRoutes:function(n,r){var t=u.keys(r).reverse();u.each(t,function(t){var e=r[t],i=n[e];if(!i)throw new Error("Method '"+e+"' was not found on the controller");this.route(t,e,u.bind(i,n))},this)}}),o.Application=function(t){this._initRegionManager(),this._initCallbacks=new o.Callbacks,this.vent=new n.Wreqr.EventAggregator,this.commands=new n.Wreqr.Commands,this.reqres=new n.Wreqr.RequestResponse,this.submodules={},u.extend(this,t),this.triggerMethod=o.triggerMethod},u.extend(o.Application.prototype,n.Events,{execute:function(){var t=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,t)},request:function(){var t=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,t)},addInitializer:function(t){this._initCallbacks.add(t)},start:function(t){this.triggerMethod("initialize:before",t),this._initCallbacks.run(t,this),this.triggerMethod("initialize:after",t),this.triggerMethod("start",t)},addRegions:function(t){return this._regionManager.addRegions(t)},removeRegion:function(t){this._regionManager.removeRegion(t)},module:function(t,e){var i=l(arguments);return i.unshift(this),o.Module.create.apply(o.Module,i)},_initRegionManager:function(){this._regionManager=new o.RegionManager,this.listenTo(this._regionManager,"region:add",function(t,e){this[t]=e}),this.listenTo(this._regionManager,"region:remove",function(t,e){delete this[t]})}}),o.Application.extend=o.extend,o.Module=function(t,e){this.moduleName=t,this.submodules={},this._setupInitializersAndFinalizers(),this.app=e,this.startWithParent=!0,this.triggerMethod=o.triggerMethod},u.extend(o.Module.prototype,n.Events,{addInitializer:function(t){this._initializerCallbacks.add(t)},addFinalizer:function(t){this._finalizerCallbacks.add(t)},start:function(e){this._isInitialized||(u.each(this.submodules,function(t){t.startWithParent&&t.start(e)}),this.triggerMethod("before:start",e),this._initializerCallbacks.run(e,this),this._isInitialized=!0,this.triggerMethod("start",e))},stop:function(){this._isInitialized&&(this._isInitialized=!1,o.triggerMethod.call(this,"before:stop"),u.each(this.submodules,function(t){t.stop()}),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),o.triggerMethod.call(this,"stop"))},addDefinition:function(t,e){this._runModuleDefinition(t,e)},_runModuleDefinition:function(t,e){if(t){var i=u.flatten([this,this.app,n,o,o.$,u,e]);t.apply(this,i)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new o.Callbacks,this._finalizerCallbacks=new o.Callbacks}}),u.extend(o.Module,{create:function(n,t,e){var r=n,s=l(arguments);s.splice(0,3);var i=(t=t.split(".")).length,o=[];return o[i-1]=e,u.each(t,function(t,e){var i=r;r=this._getModule(i,t,n),this._addModuleDefinition(i,r,o[e],s)},this),r},_getModule:function(t,e,i,n,r){var s=t[e];return s||(s=new o.Module(e,i),t[e]=s,t.submodules[e]=s),s},_addModuleDefinition:function(t,e,i,n){var r,s;s=u.isFunction(i)?(r=i,!0):!u.isObject(i)||(r=i.define,i.startWithParent),r&&e.addDefinition(r,n),e.startWithParent=e.startWithParent&&s,e.startWithParent&&!e.startWithParentIsConfigured&&(e.startWithParentIsConfigured=!0,t.addInitializer(function(t){e.startWithParent&&e.start(t)}))}}),o}(0,Backbone,_);Backbone.Paginator=function(h,d,f){"use strict";var t={version:"0.7.0"};return t.clientPager=h.Collection.extend({useDiacriticsPlugin:!0,useLevenshteinPlugin:!0,sortColumn:"",sortDirection:"desc",lastSortColumn:"",fieldFilterRules:[],lastFieldFilterRules:[],filterFields:"",filterExpression:"",lastFilterExpression:"",defaults_ui:{firstPage:0,currentPage:1,perPage:5,totalPages:10,pagesInRange:4},initialize:function(){this.on("add",this.addModel,this),this.on("remove",this.removeModel,this),this.setDefaults()},setDefaults:function(){var t=d.defaults(this.paginator_ui,this.defaults_ui);d.defaults(this,t)},addModel:function(t){this.origModels.push(t)},removeModel:function(t){var e=d.indexOf(this.origModels,t);this.origModels.splice(e,1)},sync:function(t,n,e){var i=this;this.setDefaults();var r={};d.each(d.result(i,"server_api"),function(t,e){d.isFunction(t)&&(t=(t=d.bind(t,i))()),r[e]=t});var s=d.clone(i.paginator_core);d.each(s,function(t,e){d.isFunction(t)&&(t=(t=d.bind(t,i))()),s[e]=t}),s=d.defaults(s,{timeout:25e3,cache:!1,type:"GET",dataType:"jsonp"}),s=d.extend(s,{data:decodeURIComponent(f.param(r)),processData:!1,url:d.result(s,"url")},e);var o=h.VERSION.split("."),a=!(0===parseInt(o[0],10)&&9===parseInt(o[1],10)&&10===parseInt(o[2],10)),l=s.success;s.success=function(t,e,i){l&&(a?l(t,e,i):l(n,t,s)),n&&n.trigger&&n.trigger("sync",n,t,s)};var u=s.error;s.error=function(t){u&&u(n,t,s),n&&n.trigger&&n.trigger("error",n,t,s)};var c=s.xhr=f.ajax(s);return n&&n.trigger&&n.trigger("request",n,c,s),c},nextPage:function(t){this.currentPage<this.information.totalPages&&(this.currentPage=++this.currentPage,this.pager(t))},previousPage:function(t){1<this.currentPage&&(this.currentPage=--this.currentPage,this.pager(t))},goTo:function(t,e){void 0!==t&&(this.currentPage=parseInt(t,10),this.pager(e))},howManyPer:function(t){if(void 0!==t){var e=this.perPage;this.perPage=parseInt(t,10),this.currentPage=Math.ceil((e*(this.currentPage-1)+1)/t),this.pager()}},setSort:function(t,e){void 0!==t&&void 0!==e&&(this.lastSortColumn=this.sortColumn,this.sortColumn=t,this.sortDirection=e,this.pager(),this.info())},setFieldFilter:function(t){d.isEmpty(t)?(this.lastFieldFilterRules=this.fieldFilterRules,this.fieldFilterRules=""):(this.lastFieldFilterRules=this.fieldFilterRules,this.fieldFilterRules=t),this.pager(),this.info()},doFakeFieldFilter:function(t){if(!d.isEmpty(t)){var e=this.origModels;return void 0===e&&(e=this.models),e=this._fieldFilter(e,t),""!==this.filterExpression&&(e=this._filter(e,this.filterFields,this.filterExpression)),e.length}},setFilter:function(t,e){void 0!==t&&void 0!==e&&(this.filterFields=t,this.lastFilterExpression=this.filterExpression,this.filterExpression=e,this.pager(),this.info())},doFakeFilter:function(t,e){if(void 0!==t&&void 0!==e){var i=this.origModels;return void 0===i&&(i=this.models),d.isEmpty(this.fieldFilterRules)||(i=this._fieldFilter(i,this.fieldFilterRules)),(i=this._filter(i,t,e)).length}},pager:function(t){var e=this,i=this.perPage,n=(e.currentPage-1)*i,r=n+i;void 0===e.origModels&&(e.origModels=e.models),e.models=e.origModels.slice(),""!==this.sortColumn&&(e.models=e._sort(e.models,this.sortColumn,this.sortDirection)),d.isEmpty(this.fieldFilterRules)||(e.models=e._fieldFilter(e.models,this.fieldFilterRules)),""!==this.filterExpression&&(e.models=e._filter(e.models,this.filterFields,this.filterExpression)),this.lastSortColumn===this.sortColumn&&this.lastFilterExpression===this.filterExpression&&d.isEqual(this.fieldFilterRules,this.lastFieldFilterRules)||(r=(n=0)+i,e.currentPage=1,this.lastSortColumn=this.sortColumn,this.lastFieldFilterRules=this.fieldFilterRules,this.lastFilterExpression=this.filterExpression),e.sortedAndFilteredModels=e.models.slice(),e.info(),e.reset(e.models.slice(n,r)),d.result(t,"success")},_sort:function(t,o,a){return t=t.sort(function(t,e){var i=t.get(o),n=e.get(o);if(d.isUndefined(i)||d.isUndefined(n)||null===i||null===n)return 0;if(i=i.toString().toLowerCase(),n=n.toString().toLowerCase(),"desc"===a)if(!i.match(/[^\-\d\.]/)&&i.match(/-?[\d\.]+/)&&!n.match(/[^\-\d\.]/)&&n.match(/-?[\d\.]+/)){if(i-0<n-0)return 1;if(n-0<i-0)return-1}else{if(i<n)return 1;if(n<i)return-1}else if(!i.match(/[^\-\d\.]/)&&i.match(/-?[\d\.]+/)&&!n.match(/[^\-\d\.]/)&&n.match(/-?[\d\.]+/)){if(i-0<n-0)return-1;if(n-0<i-0)return 1}else{if(i<n)return-1;if(n<i)return 1}if(t.cid&&e.cid){var r=t.cid,s=e.cid;if(r<s)return-1;if(s<r)return 1}return 0})},_fieldFilter:function(t,e){if(d.isEmpty(e))return t;var n=[];return d.each(t,function(i){var t=!0;d.each(e,function(e){if(!t)return!1;(t=!1,"function"===e.type)?d.wrap(e.value,function(t){return t(i.get(e.field))})()&&(t=!0):"required"===e.type?d.isEmpty(i.get(e.field).toString())||(t=!0):"min"===e.type?!d.isNaN(Number(i.get(e.field)))&&!d.isNaN(Number(e.value))&&Number(i.get(e.field))>=Number(e.value)&&(t=!0):"max"===e.type?!d.isNaN(Number(i.get(e.field)))&&!d.isNaN(Number(e.value))&&Number(i.get(e.field))<=Number(e.value)&&(t=!0):"range"===e.type?!d.isNaN(Number(i.get(e.field)))&&d.isObject(e.value)&&!d.isNaN(Number(e.value.min))&&!d.isNaN(Number(e.value.max))&&Number(i.get(e.field))>=Number(e.value.min)&&Number(i.get(e.field))<=Number(e.value.max)&&(t=!0):"minLength"===e.type?i.get(e.field).toString().length>=e.value&&(t=!0):"maxLength"===e.type?i.get(e.field).toString().length<=e.value&&(t=!0):"rangeLength"===e.type?d.isObject(e.value)&&!d.isNaN(Number(e.value.min))&&!d.isNaN(Number(e.value.max))&&i.get(e.field).toString().length>=e.value.min&&i.get(e.field).toString().length<=e.value.max&&(t=!0):"oneOf"===e.type?d.isArray(e.value)&&d.include(e.value,i.get(e.field))&&(t=!0):"equalTo"===e.type?e.value===i.get(e.field)&&(t=!0):"containsAllOf"===e.type?d.isArray(e.value)&&d.isArray(i.get(e.field))&&d.intersection(e.value,i.get(e.field)).length===e.value.length&&(t=!0):"pattern"===e.type?i.get(e.field).toString().match(e.value)&&(t=!0):t=!1}),t&&n.push(i)}),n},_filter:function(t,e,a){var l=this,i={};if(d.isString(e)?i[e]={cmp_method:"regexp"}:d.isArray(e)?d.each(e,function(t){i[t]={cmp_method:"regexp"}}):d.each(e,function(t,e){i[e]=d.defaults(t,{cmp_method:"regexp"})}),e=i,d.has(h.Paginator,"removeDiacritics")&&l.useDiacriticsPlugin&&(a=h.Paginator.removeDiacritics(a)),""===a||!d.isString(a))return t;var u=d.map(a.match(/\w+/gi),function(t){return t.toLowerCase()}),n="("+d.uniq(u).join("|")+")",c=new RegExp(n,"igm"),r=[];return d.each(t,function(s){var o=[];d.each(e,function(t,e){var i=s.get(e);if(i){var n=[];if(i=d.has(h.Paginator,"removeDiacritics")&&l.useDiacriticsPlugin?h.Paginator.removeDiacritics(i.toString()):i.toString(),"levenshtein"===t.cmp_method&&d.has(h.Paginator,"levenshtein")&&l.useLevenshteinPlugin){var r=h.Paginator.levenshtein(i,a);d.defaults(t,{max_distance:0}),r<=t.max_distance&&(n=d.uniq(u))}else n=i.match(c);n=d.map(n,function(t){return t.toString().toLowerCase()}),d.each(n,function(t){o.push(t)})}}),o=d.uniq(d.without(o,"")),d.isEmpty(d.difference(u,o))&&r.push(s)}),r},info:function(){var t=this,e={},i=t.sortedAndFilteredModels?t.sortedAndFilteredModels.length:t.length,n=Math.ceil(i/t.perPage);return e={totalUnfilteredRecords:t.origModels.length,totalRecords:i,currentPage:t.currentPage,perPage:this.perPage,totalPages:n,lastPage:n,previous:!1,next:!1,startRecord:0===i?0:(t.currentPage-1)*this.perPage+1,endRecord:Math.min(i,t.currentPage*this.perPage)},1<t.currentPage&&(e.previous=t.currentPage-1),t.currentPage<e.totalPages&&(e.next=t.currentPage+1),e.pageSet=t.setPagination(e),t.information=e},setPagination:function(t){var e=[],i=0,n=0,r=2*this.pagesInRange,s=Math.ceil(t.totalRecords/t.perPage);if(1<s)if(s<=1+r)for(i=1,n=s;i<=n;i++)e.push(i);else if(t.currentPage<=this.pagesInRange+1)for(i=1,n=2+r;i<n;i++)e.push(i);else if(s-this.pagesInRange>t.currentPage&&t.currentPage>this.pagesInRange)for(i=t.currentPage-this.pagesInRange;i<=t.currentPage+this.pagesInRange;i++)e.push(i);else for(i=s-r;i<=s;i++)e.push(i);return e},bootstrap:function(t){return d.extend(this,t),this.goTo(1),this.info(),this}}),t.clientPager.prototype.prevPage=t.clientPager.prototype.previousPage,t.requestPager=h.Collection.extend({sync:function(t,n,e){var i=this;i.setDefaults();var r={};d.each(d.result(i,"server_api"),function(t,e){d.isFunction(t)&&(t=(t=d.bind(t,i))()),r[e]=t});var s=d.clone(i.paginator_core);d.each(s,function(t,e){d.isFunction(t)&&(t=(t=d.bind(t,i))()),s[e]=t}),s=d.defaults(s,{timeout:25e3,cache:!1,type:"GET",dataType:"jsonp"}),e.data?e.data=decodeURIComponent(f.param(d.extend(r,e.data))):e.data=decodeURIComponent(f.param(r)),s=d.extend(s,{data:decodeURIComponent(f.param(r)),processData:!1,url:d.result(s,"url")},e);var o=h.VERSION.split("."),a=!(0===parseInt(o[0],10)&&9===parseInt(o[1],10)&&10===parseInt(o[2],10)),l=s.success;s.success=function(t,e,i){l&&(a?l(t,e,i):l(n,t,s)),n&&n.trigger&&n.trigger("sync",n,t,s)};var u=s.error;s.error=function(t){u&&u(n,t,s),n&&n.trigger&&n.trigger("error",n,t,s)};var c=s.xhr=f.ajax(s);return n&&n.trigger&&n.trigger("request",n,c,s),c},setDefaults:function(){var i=this;d.defaults(i.paginator_ui,{firstPage:0,currentPage:1,perPage:5,totalPages:10,pagesInRange:4}),d.each(i.paginator_ui,function(t,e){d.isUndefined(i[e])&&(i[e]=i.paginator_ui[e])})},requestNextPage:function(t){if(void 0!==this.currentPage)return this.currentPage+=1,this.pager(t);var e=new f.Deferred;return e.reject(),e.promise()},requestPreviousPage:function(t){if(void 0!==this.currentPage)return this.currentPage-=1,this.pager(t);var e=new f.Deferred;return e.reject(),e.promise()},updateOrder:function(t){void 0!==t&&(this.sortField=t,this.pager())},goTo:function(t,e){if(void 0!==t)return this.currentPage=parseInt(t,10),this.pager(e);var i=new f.Deferred;return i.reject(),i.promise()},howManyPer:function(t){void 0!==t&&(this.currentPage=this.firstPage,this.perPage=t,this.pager())},info:function(){var t={totalRecords:this.totalRecords||0,currentPage:this.currentPage,firstPage:this.firstPage,totalPages:Math.ceil(this.totalRecords/this.perPage),lastPage:this.totalPages,perPage:this.perPage,previous:!1,next:!1};return 1<this.currentPage&&(t.previous=this.currentPage-1),this.currentPage<t.totalPages&&(t.next=this.currentPage+1),t.hasNext=t.next,t.hasPrevious=t.next,t.pageSet=this.setPagination(t),this.information=t},setPagination:function(t){var e=[],i=0,n=0,r=2*this.pagesInRange,s=Math.ceil(t.totalRecords/t.perPage);if(1<s)if(s<=1+r)for(i=1,n=s;i<=n;i++)e.push(i);else if(t.currentPage<=this.pagesInRange+1)for(i=1,n=2+r;i<n;i++)e.push(i);else if(s-this.pagesInRange>t.currentPage&&t.currentPage>this.pagesInRange)for(i=t.currentPage-this.pagesInRange;i<=t.currentPage+this.pagesInRange;i++)e.push(i);else for(i=s-r;i<=s;i++)e.push(i);return e},pager:function(t){return d.isObject(t)||(t={}),this.fetch(t)},url:function(){return void 0!==this.paginator_core&&void 0!==this.paginator_core.url?this.paginator_core.url:null},bootstrap:function(t){return d.extend(this,t),this.setDefaults(),this.info(),this}}),t.requestPager.prototype.nextPage=t.requestPager.prototype.requestNextPage,t.requestPager.prototype.prevPage=t.requestPager.prototype.requestPreviousPage,t}(Backbone,_,jQuery);
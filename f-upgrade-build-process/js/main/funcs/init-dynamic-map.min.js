module.exports=function(){var e=require("../jquery"),t=function(t){var i,n,o,s,a,l,r,p,g=t.attr("data-locations-node"),u=(new google.maps.Size(36,43),new google.maps.Size(0,-30)),d=[{featureType:"landscape",stylers:[{saturation:-60},{lightness:65},{visibility:"on"}]},{featureType:"poi",stylers:[{saturation:-40},{lightness:40},{visibility:"simplified"}]},{featureType:"road.highway",stylers:[{saturation:-80},{lightness:40},{visibility:"simplified"}]},{featureType:"road.arterial",stylers:[{saturation:-60},{lightness:40},{visibility:"on"}]},{featureType:"road.local",stylers:[{saturation:-60},{lightness:40},{visibility:"on"}]},{featureType:"transit",stylers:[{saturation:-60},{lightness:40},{visibility:"simplified"}]},{featureType:"administrative.province",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"on"},{lightness:-10},{saturation:10}]},{featureType:"water",elementType:"geometry",stylers:[{lightness:-10},{saturation:10}]},{featureType:"transit.station",stylers:[{saturation:30},{lightness:-10},{visibility:"on"}]}],c=function(e,t,i,n){google.maps.event.addListener(t,"click",function(){l.setContent('<span class="marker-description">'+n+"</span>"),l.setPosition(t.position),l.open(e),e.panTo(t.position)})};e.ajax({url:"//www.city.ac.uk/api/google-map-locations?root="+g,dataType:"json"}).done(function(e){var t,o;null!==e&&(r=e,a=new google.maps.Map(document.getElementById("dynamic-gmap"),{scrollwheel:!1,streetViewControl:!1,zoom:r.loadOptions.zoom,center:new google.maps.LatLng(r.loadOptions.latitude,r.loadOptions.longitude),styles:d}),l=new google.maps.InfoWindow({pixelOffset:u}),function(e){for(i=0;i<e.length;i++)n=e[i],o=new google.maps.Marker({icon:{url:n.icon},map:a,visible:!0,position:new google.maps.LatLng(n.latitude,n.longitude),title:n.name}),new InfoBox({content:o.title,position:o.position,pane:"mapPane",closeBoxURL:"",disableAutoPan:!0,boxStyle:{width:"auto"}}).open(a),c(a,o,0,n.description+"&nbsp;")}(r.markers),t=a,o=r.centerMarker,(s=new google.maps.Marker({icon:{url:o.icon},map:t,visible:!0,position:new google.maps.LatLng(o.latitude,o.longitude),title:o.name})).setZIndex(180),google.maps.event.addListener(s,"click",function(){l.setContent('<span class="marker-title">'+s.title+'</span><span class="marker-description">'+o.description+"</span>"),l.setPosition(s.position),l.open(t)}),google.maps.event.addDomListener(window,"resize",function(){p=a.getCenter(),google.maps.event.trigger(a,"resize"),a.setCenter(p)}))})};return function(i){i.length>0&&e.getMultiJsScripts(["lib/google/map/infobox-packed-1.1.9.js"],t.bind(null,i))}}();
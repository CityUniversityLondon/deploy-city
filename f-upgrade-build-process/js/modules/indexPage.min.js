CITY.indexPage=function(e,t){return{init:function(){var a,i=t("html, body"),n=t(".index-form"),l=t("#index-query",n),r=t("#results-wrapper"),s=r.find("#results"),d=t("#current-query"),c=t("#active-filters"),o=t("#filtered-by"),f=t("#reload"),u=t("<span/>",{class:"loader",id:"course-loader",text:"loading..."}),m=null,h=t("<li/>",{class:"no-results hidden",html:'<p>Sorry, your search has resulted in 0 matches. Try selecting fewer filters or <a href="" id="reload">Start Again<span>Refresh Page</span></a>'}),p=n.attr("id").replace("-form",""),v=n.find("#collection").val(),x=null;function g(){n.find(":radio:checked").add(":checkbox:checked",n).not("#all-dates").not(".hidden").each(function(){var e=t(this),a=e.parent().text();t('<li class="active-filter"></li>').html('<a href="#" title="remove this filter">'+a+'<span class="close">remove</span></a>').click(function(t){return e.attr("checked",!1),n.submit(),!1}).appendTo(c)})}function y(e,a,n){var s;return t.param(e),l.val()||(s=e.length,e[0]={name:"",value:""},e[s]={name:"landing",value:"true"}),r.addClass("loading").prepend(u),c.empty("slow"),d.addClass("loading"),i.animate({scrollTop:0},"slow"),g(),c.children().length>=1?o.show():o.hide(),!0}function b(a,i,n,c){if(r.removeClass("loading"),s.empty(),u.remove(),l.attr("name","query"),t(a).find("total_matching").each(function(){m=t(this).text()}),x=0!==l.val().length?l.val():"All "+p,0===t(a).find("result").length)return d.html("No results found for: <strong>"+x+"</strong>"),h.addClass("visible").removeClass("hidden"),void s.append(h);"events"===p||"concerts"===p||"careers"===p?function(e){var a,i,n,l,r,d,c,o,f,u,m,h,p,v="";e.find("result").each(function(){p=t(this),a=p.find("title").text(),d=p.find("md[f='B']").text(),i=p.find("md[f='c']").text(),n=p.find("md[f='y']").text(),l=p.find("live_url").text(),c=p.find("md[f='J']").text(),o=p.find("md[f='K']").text(),f=p.find("md[f='G']").text(),u=p.find("md[f='H']").text(),m=p.find("md[f='I']").text(),p.find("md[f='E']").text(),h=p.find("md[f='M']").text(),r=p.find("md[f='N']").text(),v+='<li class="vevent event"><div class="date"><p class="date-month"><abbr class="dtstart" title="'+d+'">'+u+" "+m+'</abbr></p><p class="date-day-no">'+f+'</p><p class="date-day">'+o+"</p>"+(r="1"===r||"0"===r?"":'<span class="duration">'+r+" days</span>")+'</div><div class="event-details"><h2><a href="'+l+'" title="'+a+'" class="summary">'+a+'</a></h2><p class="time">'+c+'</p><p class="category">Category: '+n+'</p><p class="audience">Open to: '+h+'</p><p class="event-summary">'+i+"</p></div></li>"}),s.html(v)}(t(a)):"news"===p?function(e){var a,i,n,l,r,d,c,o="";e.find("result").each(function(){c=t(this),a=c.find("title").text(),i=0===c.find("md[f='c']").text().length?"":c.find("md[f='c']").text(),c.find("md[f='y']").text(),n=c.find("live_url").text(),d=c.find("md[f='d']").text(),c.find("md[f='E']").text(),l=c.find("md[f='G']").text(),r=0===l.length?"":'<img src="'+l+'"/>',o+='<li class="article">'+r+'<h2><a href="'+n+'" title="'+a+'" class="summary">'+a+"</a></h2><p>"+i+'</p><p class="pub-date">'+d+"</p></li>"}),s.html(o)}(t(a)):e.debug("form type not defined"),d.removeClass("loading").html(m+" results found for: <strong>"+x+"</strong>")}a=function(){var e={beforeSubmit:y,success:b,dataType:"xml",clearForm:!1,resetForm:!1,url:"//www.city.ac.uk/fb/search.xml?"};n.find("input:checkbox, input:radio").click(function(e){n.submit()}),n.ajaxForm(e)},0!==n.length&&(f.live("click",function(){location.reload()}),t("li",s).live("click",function(){return window.location=t(this).find("a").attr("href"),!1}),n.find("input").attr("autocomplete","off"),t(".apply-filter",n).remove(),n.find(".secondary-filters").hide().after(t('<a href="#" class="reveal">Show All...</a>')),t(".reveal").live("click",function(e){var a=t(e.target),i=t(e.target).prev();return a.hasClass("active")?(a.removeClass("active").text("Show More..."),i.hide()):(a.addClass("active").text("Show Fewer..."),i.show("slow")),!1}),g(),e.initMultiAccordion("h3",n,1),yepnope({load:"lib/jquery/plugins/jquery.form.js",callback:a}),e.searchAutoComplete(n,l,v))}}}(CITY,jQuery),CITY.indexPage.init();
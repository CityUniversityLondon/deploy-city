!function(t){var e,i,n,a=this,o=a.document,r=t(o),s=t(a),l=!0,c=3e4,h=!1,u=navigator.userAgent.toLowerCase(),d=a.location.hash.replace(/#\//,""),p=function(){var t=3,i=o.createElement("div"),n=i.getElementsByTagName("i");do{i.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e"}while(n[0]);return t>4?t:e}(),g=function(){return{html:o.documentElement,body:o.body,head:o.getElementsByTagName("head")[0],title:o.title}},f="data ready thumbnail loadstart loadfinish image play pause progress fullscreen_enter fullscreen_exit idle_enter idle_exit rescale lightbox_open lightbox_close lightbox_image",m=(n=[],t.each(f.split(" "),function(t,e){n.push(e),/_/.test(e)&&n.push(e.replace(/_/g,""))}),n),y=function(e){var i;return"object"!=typeof e?e:(t.each(e,function(n,a){/^[a-z]+_/.test(n)&&(i="",t.each(n.split("_"),function(t,e){i+=t>0?e.substr(0,1).toUpperCase()+e.substr(1):e}),e[i]=a,delete e[n])}),e)},v=function(e){return t.inArray(e,m)>-1?Galleria[e.toUpperCase()]:e},_={trunk:{},add:function(t,e,i,n){if(n=n||!1,this.clear(t),n){var o=e;e=function(){o(),_.add(t,e,i)}}this.trunk[t]=a.setTimeout(e,i)},clear:function(t){var e,i=function(t){a.clearTimeout(this.trunk[t]),delete this.trunk[t]};if(t&&t in this.trunk)i.call(_,t);else if(void 0===t)for(e in this.trunk)this.trunk.hasOwnProperty(e)&&i.call(_,e)}},b=[],x=[],w=!1,T=!1,k=[],G=function(e){Galleria.theme=e,t.each(k,function(t,e){e._init.call(e)})},C=function(){return{array:function(t){return Array.prototype.slice.call(t,0)},create:function(t,e){e=e||"div";var i=o.createElement(e);return i.className=t,i},getScriptPath:function(e){var i=(e=e||t("script:last").attr("src")).split("/");return 1==i.length?"":(i.pop(),i.join("/")+"/")},animate:(T=function(t){var e,i="transition WebkitTransition MozTransition OTransition".split(" ");if(a.opera)return!1;for(e=0;i[e];e++)if(void 0!==t[i[e]])return i[e];return!1}((o.body||o.documentElement).style),k={MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[T],G={_default:[.25,.1,.25,1],galleria:[.645,.045,.355,1],galleriaIn:[.55,.085,.68,.53],galleriaOut:[.25,.46,.45,.94],ease:[.25,0,.25,1],linear:[.25,.25,.75,.75],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]},I=function(e,i,n){var a={};n=n||"transition",t.each("webkit moz ms o".split(" "),function(){a["-"+this+"-"+n]=i}),e.css(a)},S=function(t){I(t,"none","transition"),Galleria.WEBKIT&&Galleria.TOUCH&&(I(t,"translate3d(0,0,0)","transform"),t.data("revert")&&(t.css(t.data("revert")),t.data("revert",null)))},function(e,i,n){if(n=t.extend({duration:400,complete:function(){},stop:!1},n),e=t(e),!n.duration)return e.css(i),void n.complete.call(e[0]);T?(n.stop&&(e.unbind(k),S(e)),f=!1,t.each(i,function(t,i){w=e.css(t),C.parseValue(w)!=C.parseValue(i)&&(f=!0),e.css(t,w)}),f?(m=[],y=n.easing in G?G[n.easing]:G._default,v=" "+n.duration+"ms cubic-bezier("+y.join(",")+")",a.setTimeout(function(){e.one(k,function(t){return function(){S(t),n.complete.call(t[0])}}(e)),Galleria.WEBKIT&&Galleria.TOUCH&&(b={},x=[0,0,0],t.each(["left","top"],function(t,n){n in i&&(x[t]=C.parseValue(i[n])-C.parseValue(e.css(n))+"px",b[n]=i[n],delete i[n])}),(x[0]||x[1])&&(e.data("revert",b),m.push("-webkit-transform"+v),I(e,"translate3d("+x.join(",")+")","transform"))),t.each(i,function(t,e){m.push(t+v)}),I(e,m.join(",")),e.css(i)},1)):a.setTimeout(function(){n.complete.call(e[0])},n.duration)):e.animate(i,n)}),removeAlpha:function(t){if(p<9&&t){var e=t.style,i=t.currentStyle,n=i&&i.filter||e.filter||"";/alpha/.test(n)&&(e.filter=n.replace(/alpha\([^)]*\)/i,""))}},forceStyles:function(e,i){(e=t(e)).attr("style")&&e.data("styles",e.attr("style")).removeAttr("style"),e.css(i)},revertStyles:function(){t.each(C.array(arguments),function(e,i){(i=t(i)).removeAttr("style"),i.attr("style",""),i.data("styles")&&i.attr("style",i.data("styles")).data("styles",null)})},moveOut:function(t){C.forceStyles(t,{position:"absolute",left:-1e4})},moveIn:function(){C.revertStyles.apply(C,C.array(arguments))},elem:function(e){return e instanceof t?{$:e,dom:e[0]}:{$:t(e),dom:e}},hide:function(t,e,i){i=i||function(){};var n=C.elem(t),a=n.$;t=n.dom,a.data("opacity")||a.data("opacity",a.css("opacity"));var o={opacity:0};if(e){var r=p<9&&t?function(){C.removeAlpha(t),t.style.visibility="hidden",i.call(t)}:i;C.animate(t,o,{duration:e,complete:r,stop:!0})}else p<9&&t?(C.removeAlpha(t),t.style.visibility="hidden"):a.css(o)},show:function(t,e,i){i=i||function(){};var n=C.elem(t),a=n.$;t=n.dom;var o={opacity:parseFloat(a.data("opacity"))||1};if(e){p<9&&(a.css("opacity",0),t.style.visibility="visible");var r=p<9&&t?function(){1==o.opacity&&C.removeAlpha(t),i.call(t)}:i;C.animate(t,o,{duration:e,complete:r,stop:!0})}else p<9&&1==o.opacity&&t?(C.removeAlpha(t),t.style.visibility="visible"):a.css(o)},optimizeTouch:(c={},h=function(e){e.preventDefault(),c=t.extend({},e,!0)},u=function(){this.evt=c},d=function(){this.handler.call(i,this.evt)},function(e){t(e).bind("touchend",function(e){for(i=e.target,s=!0;i.parentNode&&i!=e.currentTarget&&s;)n=t(i).data("events"),r=t(i).data("fakes"),n&&"click"in n?(s=!1,e.preventDefault(),t(i).click(h).click(),n.click.pop(),t.each(n.click,u),t(i).data("fakes",n.click),delete n.click):r&&(s=!1,e.preventDefault(),t.each(r,d)),i=i.parentNode})}),addTimer:function(){return _.add.apply(_,C.array(arguments)),this},clearTimer:function(){return _.clear.apply(_,C.array(arguments)),this},wait:function(e){e=t.extend({until:function(){return!1},success:function(){},error:function(){Galleria.raise("Could not complete wait function.")},timeout:3e3},e);var i,n,o=C.timestamp(),r=function(){return n=C.timestamp(),i=n-o,e.until(i)?(e.success(),!1):n>=o+e.timeout?(e.error(),!1):void a.setTimeout(r,10)};a.setTimeout(r,10)},toggleQuality:function(t,e){7!==p&&8!==p||!t||(void 0===e&&(e="nearest-neighbor"===t.style.msInterpolationMode),t.style.msInterpolationMode=e?"bicubic":"nearest-neighbor")},insertStyleTag:function(t){var e=o.createElement("style");if(g().head.appendChild(e),e.styleSheet)e.styleSheet.cssText=t;else{var i=o.createTextNode(t);e.appendChild(i)}},loadScript:function(e,i){var n=!1,a=t("<script>").attr({src:e,async:!0}).get(0);a.onload=a.onreadystatechange=function(){n||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(n=!0,a.onload=a.onreadystatechange=null,"function"==typeof i&&i.call(this,this))},g().head.appendChild(a)},parseValue:function(t){if("number"==typeof t)return t;if("string"==typeof t){var e=t.match(/\-?\d|\./g);return e&&e.constructor===Array?1*e.join(""):0}return 0},timestamp:function(){return(new Date).getTime()},loadCSS:function(i,n,r){var s,c,h=!1;return t("link[rel=stylesheet]").each(function(){if(new RegExp(i).test(this.href))return s=this,!1}),"function"==typeof n&&(r=n,n=e),r=r||function(){},s?(r.call(s,s),s):(c=o.styleSheets.length,l&&(i+="?"+C.timestamp()),t("#"+n).length?(t("#"+n).attr("href",i),c--,h=!0):(s=t("<link>").attr({rel:"stylesheet",href:i,id:n}).get(0),a.setTimeout(function(){var e=t('link[rel="stylesheet"], style');if(e.length?e.get(0).parentNode.insertBefore(s,e[0]):g().head.appendChild(s),p){if(c>=31)return void Galleria.raise("You have reached the browser stylesheet limit (31)",!0);s.onreadystatechange=function(t){h||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(h=!0)}}else new RegExp("file://","i").test(i)?h=!0:t.ajax({url:i,success:function(){h=!0},error:function(t){t.isRejected()&&Galleria.WEBKIT&&(h=!0)}})},10)),"function"==typeof r&&C.wait({until:function(){return h&&o.styleSheets.length>c},success:function(){a.setTimeout(function(){r.call(s,s)},100)},error:function(){Galleria.raise("Theme CSS could not load",!0)},timeout:1e4}),s)}};var i,n,r,s,c,h,u,d,f,m,y,v,b,x,w,T,k,G,I,S}(),I=(i=function(e,i,n,a){var o,r=this.getOptions("easing"),s=this.getStageWidth(),l={left:s*(e.rewind?-1:1)},c={left:0};n&&(l.opacity=0,c.opacity=1),t(e.next).css(l),C.animate(e.next,c,{duration:e.speed,complete:(o=t(e.next).add(e.prev),function(){i(),o.css({left:0})}),queue:!1,easing:r}),a&&(e.rewind=!e.rewind),e.prev&&(l={left:0},c={left:s*(e.rewind?1:-1)},n&&(l.opacity=1,c.opacity=0),t(e.prev).css(l),C.animate(e.prev,c,{duration:e.speed,queue:!1,easing:r,complete:function(){t(this).css("opacity",0)}}))},{fade:function(e,i){t(e.next).css("opacity",0).show(),C.animate(e.next,{opacity:1},{duration:e.speed,complete:i}),e.prev&&(t(e.prev).css("opacity",1).show(),C.animate(e.prev,{opacity:0},{duration:e.speed}))},flash:function(e,i){t(e.next).css("opacity",0),e.prev?C.animate(e.prev,{opacity:0},{duration:e.speed/2,complete:function(){C.animate(e.next,{opacity:1},{duration:e.speed,complete:i})}}):C.animate(e.next,{opacity:1},{duration:e.speed,complete:i})},pulse:function(e,i){e.prev&&t(e.prev).hide(),t(e.next).css("opacity",0).show(),C.animate(e.next,{opacity:1},{duration:e.speed,complete:i})},slide:function(t,e){i.apply(this,C.array(arguments))},fadeslide:function(t,e){i.apply(this,C.array(arguments).concat([!0]))},doorslide:function(t,e){i.apply(this,C.array(arguments).concat([!1,!0]))}});Galleria=function(){var i=this;this._theme=e,this._options={},this._playing=!1,this._playtime=5e3,this._active=null,this._queue={length:0},this._data=[],this._dom={},this._thumbnails=[],this._layers=[],this._initialized=!1,this._firstrun=!1,this._stageWidth=0,this._stageHeight=0,this._target=e,this._id=Math.random();t.each("container stage images image-nav image-nav-left image-nav-right info info-text info-title info-description thumbnails thumbnails-list thumbnails-container thumb-nav-left thumb-nav-right loader counter tooltip".split(" "),function(t,e){i._dom[e]=C.create("galleria-"+e)}),t.each("current total".split(" "),function(t,e){i._dom[e]=C.create("galleria-"+e,"span")});var n=this._keyboard={keys:{UP:38,DOWN:40,LEFT:37,RIGHT:39,RETURN:13,ESCAPE:27,BACKSPACE:8,SPACE:32},map:{},bound:!1,press:function(t){var e=t.keyCode||t.which;e in n.map&&"function"==typeof n.map[e]&&n.map[e].call(i,t)},attach:function(t){var e,i;for(e in t)t.hasOwnProperty(e)&&((i=e.toUpperCase())in n.keys?n.map[n.keys[i]]=t[e]:n.map[i]=t[e]);n.bound||(n.bound=!0,r.bind("keydown",n.press))},detach:function(){n.bound=!1,n.map={},r.unbind("keydown",n.press)}},o=this._controls={0:e,1:e,active:0,swap:function(){o.active=o.active?0:1},getActive:function(){return o[o.active]},getNext:function(){return o[1-o.active]}},l=this._carousel={next:i.$("thumb-nav-right"),prev:i.$("thumb-nav-left"),width:0,current:0,max:0,hooks:[],update:function(){var e=0,n=0,a=[0];t.each(i._thumbnails,function(i,o){o.ready&&(e+=o.outerWidth||t(o.container).outerWidth(!0),a[i+1]=e,n=Math.max(n,o.outerHeight||t(o.container).outerHeight(!0)))}),i.$("thumbnails").css({width:e,height:n}),l.max=e,l.hooks=a,l.width=i.$("thumbnails-list").width(),l.setClasses(),i.$("thumbnails-container").toggleClass("galleria-carousel",e>l.width),l.width=i.$("thumbnails-list").width()},bindControls:function(){var t;l.next.bind("click",function(e){if(e.preventDefault(),"auto"===i._options.carouselSteps){for(t=l.current;t<l.hooks.length;t++)if(l.hooks[t]-l.hooks[l.current]>l.width){l.set(t-2);break}}else l.set(l.current+i._options.carouselSteps)}),l.prev.bind("click",function(e){if(e.preventDefault(),"auto"===i._options.carouselSteps)for(t=l.current;t>=0;t--){if(l.hooks[l.current]-l.hooks[t]>l.width){l.set(t+2);break}if(0===t){l.set(0);break}}else l.set(l.current-i._options.carouselSteps)})},set:function(t){for(t=Math.max(t,0);l.hooks[t-1]+l.width>=l.max&&t>=0;)t--;l.current=t,l.animate()},getLast:function(t){return(t||l.current)-1},follow:function(t){if(0!==t&&t!==l.hooks.length-2){for(var e=l.current;l.hooks[e]-l.hooks[l.current]<l.width&&e<=l.hooks.length;)e++;t-1<l.current?l.set(t-1):t+2>e&&l.set(t-e+l.current+2)}else l.set(t)},setClasses:function(){l.prev.toggleClass("disabled",!l.current),l.next.toggleClass("disabled",l.hooks[l.current]+l.width>=l.max)},animate:function(t){l.setClasses();var e=-1*l.hooks[l.current];isNaN(e)||C.animate(i.get("thumbnails"),{left:e},{duration:i._options.carouselSpeed,easing:i._options.easing,queue:!1})}},c=this._tooltip={initialized:!1,open:!1,init:function(){c.initialized=!0;C.insertStyleTag(".galleria-tooltip{padding:3px 8px;max-width:50%;background:#ffe;color:#000;z-index:3;position:absolute;font-size:11px;line-height:1.3opacity:0;box-shadow:0 0 2px rgba(0,0,0,.4);-moz-box-shadow:0 0 2px rgba(0,0,0,.4);-webkit-box-shadow:0 0 2px rgba(0,0,0,.4);}"),i.$("tooltip").css("opacity",.8),C.hide(i.get("tooltip"))},move:function(t){var e=i.getMousePosition(t).x,n=i.getMousePosition(t).y,a=i.$("tooltip"),o=e,r=n,s=a.outerHeight(!0)+1,l=a.outerWidth(!0),c=s+15,h=i.$("container").width()-l-2,u=i.$("container").height()-s-2;isNaN(o)||isNaN(r)||(o+=10,r-=30,o=Math.max(0,Math.min(h,o)),r=Math.max(0,Math.min(u,r)),n<c&&(r=c),a.css({left:o,top:r}))},bind:function(e,n){if(!Galleria.TOUCH){c.initialized||c.init();var a=function(e,n){c.define(e,n),t(e).hover(function(){C.clearTimer("switch_tooltip"),i.$("container").unbind("mousemove",c.move).bind("mousemove",c.move).trigger("mousemove"),c.show(e),Galleria.utils.addTimer("tooltip",function(){i.$("tooltip").stop().show().animate({opacity:1}),c.open=!0},c.open?0:500)},function(){i.$("container").unbind("mousemove",c.move),C.clearTimer("tooltip"),i.$("tooltip").stop().animate({opacity:0},200,function(){i.$("tooltip").hide(),C.addTimer("switch_tooltip",function(){c.open=!1},1e3)})})};"string"==typeof n?a(e in i._dom?i.get(e):e,n):t.each(e,function(t,e){a(i.get(t),e)})}},show:function(e){var n=(e=t(e in i._dom?i.get(e):e)).data("tt"),o=function(t){var i;a.setTimeout((i=t,function(){c.move(i)}),10),e.unbind("mouseup",o)};(n="function"==typeof n?n():n)&&(i.$("tooltip").html(n.replace(/\s/,"&nbsp;")),e.bind("mouseup",o))},define:function(e,n){if("function"!=typeof n){var a=n;n=function(){return a}}e=t(e in i._dom?i.get(e):e).data("tt",n),c.show(e)}},h=this._fullscreen={scrolled:0,crop:i._options.imageCrop,active:!1,keymap:i._keyboard.map,enter:function(n){h.active=!0,C.hide(i.getActiveImage()),i.$("container").addClass("fullscreen"),h.scrolled=s.scrollTop(),C.forceStyles(i.get("container"),{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:1e4});var a={height:"100%",overflow:"hidden",margin:0,padding:0},o=i.getData();if(C.forceStyles(g().html,a),C.forceStyles(g().body,a),h.keymap=t.extend({},i._keyboard.map),i.attachKeyboard({escape:i.exitFullscreen,right:i.next,left:i.prev}),i._options.fullscreenCrop!==e&&(i._options.imageCrop=i._options.fullscreenCrop),o&&o.big&&o.image!==o.big){var r=new Galleria.Picture,l=r.isCached(o.big),c=i.getIndex(),u=i._thumbnails[c];i.trigger({type:Galleria.LOADSTART,cached:l,rewind:!1,index:c,imageTarget:i.getActiveImage(),thumbTarget:u}),r.load(o.big,function(e){i._scaleImage(e,{complete:function(e){i.trigger({type:Galleria.LOADFINISH,cached:l,index:c,rewind:!1,imageTarget:e.image,thumbTarget:u});var n=i._controls.getActive().image;n&&t(n).width(e.image.width).height(e.image.height).attr("style",t(e.image).attr("style")).attr("src",e.image.src)}})})}i.rescale(function(){C.addTimer("fullscreen_enter",function(){C.show(i.getActiveImage()),"function"==typeof n&&n.call(i)},100),i.trigger(Galleria.FULLSCREEN_ENTER)}),s.resize(function(){h.scale()})},scale:function(){i.rescale()},exit:function(t){h.active=!1,C.hide(i.getActiveImage()),i.$("container").removeClass("fullscreen"),C.revertStyles(i.get("container"),g().html,g().body),a.scrollTo(0,h.scrolled),i.detachKeyboard(),i.attachKeyboard(h.keymap),i._options.fullscreenCrop!==e&&(i._options.imageCrop=h.crop),i.rescale(function(){C.addTimer("fullscreen_exit",function(){C.show(i.getActiveImage()),"function"==typeof t&&t.call(i)},50),i.trigger(Galleria.FULLSCREEN_EXIT)}),s.unbind("resize",h.scale)}},u=this._idle={trunk:[],bound:!1,add:function(e,i){if(e){u.bound||u.addEvent(),e=t(e);var n,a={};for(n in i)i.hasOwnProperty(n)&&(a[n]=e.css(n));e.data("idle",{from:a,to:i,complete:!0,busy:!1}),u.addTimer(),u.trunk.push(e)}},remove:function(e){e=jQuery(e),t.each(u.trunk,function(t,n){n.length&&!n.not(e).length&&(i._idle.show(e),i._idle.trunk.splice(t,1))}),u.trunk.length||(u.removeEvent(),C.clearTimer("idle"))},addEvent:function(){u.bound=!0,i.$("container").bind("mousemove click",u.showAll)},removeEvent:function(){u.bound=!1,i.$("container").unbind("mousemove click",u.showAll)},addTimer:function(){C.addTimer("idle",function(){i._idle.hide()},i._options.idleTime)},hide:function(){i._options.idleMode&&(i.trigger(Galleria.IDLE_ENTER),t.each(u.trunk,function(t,e){var n=e.data("idle");n&&(e.data("idle").complete=!1,C.animate(e,n.to,{duration:i._options.idleSpeed}))}))},showAll:function(){C.clearTimer("idle"),t.each(i._idle.trunk,function(t,e){i._idle.show(e)})},show:function(e){var n=e.data("idle");n.busy||n.complete||(n.busy=!0,i.trigger(Galleria.IDLE_EXIT),C.clearTimer("idle"),C.animate(e,n.from,{duration:i._options.idleSpeed/2,complete:function(){t(this).data("idle").busy=!1,t(this).data("idle").complete=!0}})),u.addTimer()}},d=this._lightbox={width:0,height:0,initialized:!1,active:null,image:null,elems:{},keymap:!1,init:function(){if(i.trigger(Galleria.LIGHTBOX_OPEN),!d.initialized){d.initialized=!0;var e={},n=i._options,a="",o="position:absolute;",r={overlay:"position:fixed;display:none;opacity:"+n.overlayOpacity+";filter:alpha(opacity="+100*n.overlayOpacity+");top:0;left:0;width:100%;height:100%;background:"+n.overlayBackground+";z-index:99990",box:"position:fixed;display:none;width:400px;height:400px;top:50%;left:50%;margin-top:-200px;margin-left:-200px;z-index:99991",shadow:o+"background:#000;width:100%;height:100%;",content:o+"background-color:#fff;top:10px;left:10px;right:10px;bottom:10px;overflow:hidden",info:o+"bottom:10px;left:10px;right:10px;color:#444;font:11px/13px arial,sans-serif;height:13px",close:o+"top:10px;right:10px;height:20px;width:20px;background:#fff;text-align:center;cursor:pointer;color:#444;font:16px/22px arial,sans-serif;z-index:99999",image:o+"top:10px;left:10px;right:10px;bottom:30px;overflow:hidden;display:block;",prevholder:o+"width:50%;top:0;bottom:40px;cursor:pointer;",nextholder:o+"width:50%;top:0;bottom:40px;right:-1px;cursor:pointer;",prev:o+"top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;left:20px;display:none;text-align:center;color:#000;font:bold 16px/36px arial,sans-serif",next:o+"top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;right:20px;left:auto;display:none;font:bold 16px/36px arial,sans-serif;text-align:center;color:#000",title:"float:left",counter:"float:right;margin-left:8px;"},s={};8===p&&(r.nextholder+="background:#000;filter:alpha(opacity=0);",r.prevholder+="background:#000;filter:alpha(opacity=0);"),t.each(r,function(t,e){a+=".galleria-lightbox-"+t+"{"+e+"}"}),C.insertStyleTag(a),t.each("overlay box content shadow title info close prevholder prev nextholder next counter image".split(" "),function(t,n){i.addElement("lightbox-"+n),e[n]=d.elems[n]=i.get("lightbox-"+n)}),d.image=new Galleria.Picture,t.each({box:"shadow content close prevholder nextholder",info:"title counter",content:"info image",prevholder:"prev",nextholder:"next"},function(e,i){var n=[];t.each(i.split(" "),function(t,e){n.push("lightbox-"+e)}),s["lightbox-"+e]=n}),i.append(s),t(e.image).append(d.image.container),t(g().body).append(e.overlay,e.box),C.optimizeTouch(e.box),t(e.close).bind("click",d.hide).html("&#215;").hover(function(){t(this).css("color","#bbb")},function(){t(this).css("color","#444")}),t.each(["Prev","Next"],function(i,n){var a=t(e[n.toLowerCase()]).html(/v/.test(n)?"&#8249;&nbsp;":"&nbsp;&#8250;"),o=t(e[n.toLowerCase()+"holder"]);o.bind("click",function(){d["show"+n]()}),p<8||Galleria.TOUCH?a.show():o.hover(function(){a.show()},function(t){a.stop().fadeOut(200)})}),t(e.overlay).bind("click",d.hide),Galleria.IPAD&&(i._options.lightboxTransitionSpeed=0)}},rescale:function(e){var n=Math.min(s.width()-40,d.width),a=Math.min(s.height()-60,d.height),o=Math.min(n/d.width,a/d.height),r=Math.round(d.width*o)+40,l=Math.round(d.height*o)+60,c={width:r,height:l,"margin-top":-1*Math.ceil(l/2),"margin-left":-1*Math.ceil(r/2)};e?t(d.elems.box).css(c):t(d.elems.box).animate(c,{duration:i._options.lightboxTransitionSpeed,easing:i._options.easing,complete:function(){var e=d.image,n=i._options.lightboxFadeSpeed;i.trigger({type:Galleria.LIGHTBOX_IMAGE,imageTarget:e.image}),t(e.container).show(),C.show(e.image,n),C.show(d.elems.info,n)}})},hide:function(){d.image.image=null,s.unbind("resize",d.rescale),t(d.elems.box).hide(),C.hide(d.elems.info),i.detachKeyboard(),i.attachKeyboard(d.keymap),d.keymap=!1,C.hide(d.elems.overlay,200,function(){t(this).hide().css("opacity",i._options.overlayOpacity),i.trigger(Galleria.LIGHTBOX_CLOSE)})},showNext:function(){d.show(i.getNext(d.active))},showPrev:function(){d.show(i.getPrev(d.active))},show:function(e){d.active=e="number"==typeof e?e:i.getIndex(),d.initialized||d.init(),d.keymap||(d.keymap=t.extend({},i._keyboard.map),i.attachKeyboard({escape:d.hide,right:d.showNext,left:d.showPrev})),s.unbind("resize",d.rescale);var n=i.getData(e),a=i.getDataLength();C.hide(d.elems.info),d.image.load(n.big||n.image,function(i){d.width=i.original.width,d.height=i.original.height,t(i.image).css({width:"100.5%",height:"100.5%",top:0,zIndex:99998}),C.hide(i.image),d.elems.title.innerHTML=n.title||"",d.elems.counter.innerHTML=e+1+" / "+a,s.resize(d.rescale),d.rescale()}),t(d.elems.overlay).show(),t(d.elems.box).show()}};return this},Galleria.prototype={constructor:Galleria,init:function(i,n){if(n=y(n),this._original={target:i,options:n,data:null},this._target=this._dom.target=i.nodeName?i:t(i).get(0),x.push(this),this._target)return this._options={autoplay:!1,carousel:!0,carouselFollow:!0,carouselSpeed:400,carouselSteps:"auto",clicknext:!1,dataConfig:function(t){return{}},dataSelector:"img",dataSource:this._target,debug:e,dummy:e,easing:"galleria",extend:function(t){},fullscreenCrop:e,fullscreenDoubleTap:!0,fullscreenTransition:e,height:"auto",idleMode:!0,idleTime:3e3,idleSpeed:200,imageCrop:!1,imageMargin:0,imagePan:!1,imagePanSmoothness:12,imagePosition:"50%",imageTimeout:e,initialTransition:e,keepSource:!1,layerFollow:!0,lightbox:!1,lightboxFadeSpeed:200,lightboxTransitionSpeed:200,linkSourceImages:!0,maxScaleRatio:e,minScaleRatio:e,overlayOpacity:.85,overlayBackground:"#0b0b0b",pauseOnInteraction:!0,popupLinks:!1,preload:2,queue:!0,show:0,showInfo:!0,showCounter:!0,showImagenav:!0,swipe:!0,thumbCrop:!0,thumbEventType:"click",thumbFit:!0,thumbMargin:0,thumbQuality:"auto",thumbnails:!0,touchTransition:e,transition:"fade",transitionInitial:e,transitionSpeed:400,useCanvas:!1,width:"auto"},this._options.initialTransition=this._options.initialTransition||this._options.transitionInitial,n&&!1===n.debug&&(l=!1),n&&"number"==typeof n.imageTimeout&&(c=n.imageTimeout),n&&"string"==typeof n.dummy&&(h=n.dummy),t(this._target).children().hide(),"object"==typeof Galleria.theme?this._init():k.push(this),this;Galleria.raise("Target not found.",!0)},_init:function(){var e,i,n,r,s,l,c,h,u,d,g,f,m,y=this;if(this._initialized)return Galleria.raise("Init failed: Gallery instance already initialized."),this;if(this._initialized=!0,!Galleria.theme)return Galleria.raise("Init failed: No theme found."),this;if(t.extend(!0,this._options,Galleria.theme.defaults,this._original.options),"getContext"in(e=o.createElement("canvas"))?T=T||{elem:e,context:e.getContext("2d"),cache:{},length:0}:e=null,this.bind(Galleria.DATA,function(){this._original.data=this._data,this.get("total").innerHTML=this.getDataLength();var e=this.$("container"),i={width:0,height:0},n=function(){return y.$("stage").height()};C.wait({until:function(){return t.each(["width","height"],function(t,n){y._options[n]&&"number"==typeof y._options[n]?i[n]=y._options[n]:i[n]=Math.max(C.parseValue(e.css(n)),C.parseValue(y.$("target").css(n)),e[n](),y.$("target")[n]()),e[n](i[n])}),n()&&i.width&&i.height>10},success:function(){Galleria.WEBKIT?a.setTimeout(function(){y._run()},1):y._run()},error:function(){n()?Galleria.raise("Could not extract sufficient width/height of the gallery container. Traced measures: width:"+i.width+"px, height: "+i.height+"px.",!0):Galleria.raise("Could not extract a stage height from the CSS. Traced height: "+n()+"px.",!0)},timeout:2e3})}),this.append({"info-text":["info-title","info-description"],info:["info-text"],"image-nav":["image-nav-right","image-nav-left"],stage:["images","loader","counter","image-nav"],"thumbnails-list":["thumbnails"],"thumbnails-container":["thumb-nav-left","thumbnails-list","thumb-nav-right"],container:["stage","thumbnails-container","info","tooltip"]}),C.hide(this.$("counter").append(this.get("current")," / ",this.get("total"))),this.setCounter("&#8211;"),C.hide(y.get("tooltip")),this.$("container").addClass(Galleria.TOUCH?"touch":"notouch"),t.each(new Array(2),function(e){var i=new Galleria.Picture;t(i.container).css({position:"absolute",top:0,left:0}).prepend(y._layers[e]=t(C.create("galleria-layer")).css({position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:2})[0]),y.$("images").append(i.container),y._controls[e]=i}),this.$("images").css({position:"relative",top:0,left:0,width:"100%",height:"100%"}),this.$("thumbnails, thumbnails-list").css({overflow:"hidden",position:"relative"}),this.$("image-nav-right, image-nav-left").bind("click",function(t){y._options.clicknext&&t.stopPropagation(),y._options.pauseOnInteraction&&y.pause();var e=/right/.test(this.className)?"next":"prev";y[e]()}),t.each(["info","counter","image-nav"],function(t,e){!1===y._options["show"+e.substr(0,1).toUpperCase()+e.substr(1).replace(/-/,"")]&&C.moveOut(y.get(e.toLowerCase()))}),this.load(),this._options.keep_source||p||(this._target.innerHTML=""),this.get("errors")&&this.appendChild("target","errors"),this.appendChild("target","container"),this._options.carousel){var v=0,_=this._options.show;this.bind(Galleria.THUMBNAIL,function(){this.updateCarousel(),++v==this.getDataLength()&&"number"==typeof _&&_>0&&this._carousel.follow(_)})}return this._options.swipe&&(i=y.$("images"),r=[0,0],s=[0,0],l=!1,c=0,h="touchstart",u="touchmove",d="touchend",g=function(t){return t.originalEvent.touches?t.originalEvent.touches[0]:t},f=function(t){t.originalEvent.touches&&t.originalEvent.touches.length>1||(n=g(t),s=[n.pageX,n.pageY],r[0]||(r=s),Math.abs(r[0]-s[0])>10&&t.preventDefault())},m=function(t){i.unbind(u,f),t.originalEvent.touches&&t.originalEvent.touches.length||l?l=!l:(C.timestamp()-c<1e3&&Math.abs(r[0]-s[0])>30&&Math.abs(r[1]-s[1])<100&&(t.preventDefault(),y[r[0]>s[0]?"next":"prev"]()),r=s=[0,0])},i.bind(h,function(t){t.originalEvent.touches&&t.originalEvent.touches.length>1||(n=g(t),c=C.timestamp(),r=s=[n.pageX,n.pageY],i.bind(u,f).one(d,m))}),this._options.fullscreenDoubleTap&&this.$("stage").bind("touchstart",function(){var t,e,i,n,a,o,r=function(t){return t.originalEvent.touches?t.originalEvent.touches[0]:t};return function(s){if(o=Galleria.utils.timestamp(),e=r(s).pageX,i=r(s).pageY,o-t<500&&e-n<20&&i-a<20)return y.toggleFullscreen(),s.preventDefault(),void y.$("stage").unbind("touchend",arguments.callee);t=o,n=e,a=i}}())),C.optimizeTouch(this.get("container")),this},_createThumbnails:function(){this.get("total").innerHTML=this.getDataLength();var e,i,n,r,s,l,c=this,h=this._options,u=!!(l=c.$("thumbnails").find(".active")).length&&l.find("img").attr("src"),d="string"==typeof h.thumbnails?h.thumbnails.toLowerCase():null,p=function(t){return o.defaultView&&o.defaultView.getComputedStyle?o.defaultView.getComputedStyle(n.container,null)[t]:s.css(t)},g=function(e,i,n){return function(){t(n).append(e),c.trigger({type:Galleria.THUMBNAIL,thumbTarget:e,index:i})}},f=function(e){h.pauseOnInteraction&&c.pause();var i=t(e.currentTarget).data("index");c.getIndex()!==i&&c.show(i),e.preventDefault()},m=function(e){e.scale({width:e.data.width,height:e.data.height,crop:h.thumbCrop,margin:h.thumbMargin,canvas:h.useCanvas,complete:function(e){var i,n,a=["left","top"];t.each(["Width","Height"],function(o,r){i=r.toLowerCase(),!0===h.thumbCrop&&h.thumbCrop!==i||!h.thumbFit||((n={})[i]=e[i],t(e.container).css(n),(n={})[a[o]]=0,t(e.image).css(n)),e["outer"+r]=t(e.container)["outer"+r](!0)}),C.toggleQuality(e.image,!0===h.thumbQuality||"auto"===h.thumbQuality&&e.original.width<3*e.width),c.trigger({type:Galleria.THUMBNAIL,thumbTarget:e.image,index:e.data.order})}})};for(this._thumbnails=[],this.$("thumbnails").empty(),e=0;this._data[e];e++)r=this._data[e],!0===h.thumbnails?(n=new Galleria.Picture(e),i=r.thumb||r.image,this.$("thumbnails").append(n.container),s=t(n.container),n.data={width:C.parseValue(p("width")),height:C.parseValue(p("height")),order:e},h.thumbFit&&!0!==h.thumbCrop?s.css({width:0,height:0}):s.css({width:n.data.width,height:n.data.height}),n.load(i,m),"all"===h.preload&&n.preload(r.image)):"empty"===d||"numbers"===d?(n={container:C.create("galleria-image"),image:C.create("img","span"),ready:!0},"numbers"===d&&t(n.image).text(e+1),this.$("thumbnails").append(n.container),a.setTimeout(g(n.image,e,n.container),50+20*e)):n={container:null,image:null},t(n.container).add(h.keepSource&&h.linkSourceImages?r.original:null).data("index",e).bind(h.thumbEventType,f),u===i&&t(n.container).addClass("active"),this._thumbnails.push(n)},_run:function(){var i=this;i._createThumbnails(),C.wait({until:function(){return Galleria.OPERA&&i.$("stage").css("display","inline-block"),i._stageWidth=i.$("stage").width(),i._stageHeight=i.$("stage").height(),i._stageWidth&&i._stageHeight>50},success:function(){b.push(i),C.show(i.get("counter")),i._options.carousel&&i._carousel.bindControls(),i._options.autoplay&&(i.pause(),"number"==typeof i._options.autoplay&&(i._playtime=i._options.autoplay),i.trigger(Galleria.PLAY),i._playing=!0),i._firstrun?"number"==typeof i._options.show&&i.show(i._options.show):(i._firstrun=!0,i._options.clicknext&&!Galleria.TOUCH&&(t.each(i._data,function(t,e){delete e.link}),i.$("stage").css({cursor:"pointer"}).bind("click",function(t){i._options.pauseOnInteraction&&i.pause(),i.next()})),Galleria.History&&Galleria.History.change(function(t){isNaN(t)?a.history.go(-1):i.show(t,e,!0)}),t.each(Galleria.ready.callbacks,function(){this.call(i,i._options)}),i.trigger(Galleria.READY),Galleria.theme.init.call(i,i._options),i._options.extend.call(i,i._options),/^[0-9]{1,4}$/.test(d)&&Galleria.History?i.show(d,e,!0):i._data[i._options.show]&&i.show(i._options.show))},error:function(){Galleria.raise("Stage width or height is too small to show the gallery. Traced measures: width:"+i._stageWidth+"px, height: "+i._stageHeight+"px.",!0)}})},load:function(e,i,n){var a=this;return this._data=[],this._thumbnails=[],this.$("thumbnails").empty(),"function"==typeof i&&(n=i,i=null),e=e||this._options.dataSource,i=i||this._options.dataSelector,n=n||this._options.dataConfig,/^function Object/.test(e.constructor)&&(e=[e]),e.constructor===Array?(this.validate(e)?(this._data=e,this._parseData().trigger(Galleria.DATA)):Galleria.raise("Load failed: JSON Array not valid."),this):(t(e).find(i).each(function(e,i){var o={},r=(i=t(i)).parent(),s=r.attr("href"),l=r.attr("rel");s&&(o.image=o.big=s),l&&(o.big=l),a._data.push(t.extend({title:i.attr("title")||"",thumb:i.attr("src"),image:i.attr("src"),big:i.attr("src"),description:i.attr("alt")||"",link:i.attr("longdesc"),original:i.get(0)},o,n(i)))}),this.getDataLength()?this.trigger(Galleria.DATA):Galleria.raise("Load failed: no data found."),this)},_parseData:function(){var e=this;return t.each(this._data,function(t,i){"thumb"in i==!1&&(e._data[t].thumb=i.image),!1 in i&&(e._data[t].big=i.image)}),this},splice:function(){return Array.prototype.splice.apply(this._data,C.array(arguments)),this._parseData()._createThumbnails()},push:function(){return Array.prototype.push.apply(this._data,C.array(arguments)),this._parseData()._createThumbnails()},_getActive:function(){return this._controls.getActive()},validate:function(t){return!0},bind:function(t,e){return t=v(t),this.$("container").bind(t,this.proxy(e)),this},unbind:function(t){return t=v(t),this.$("container").unbind(t),this},trigger:function(e){return e="object"==typeof e?t.extend(e,{scope:this}):{type:v(e),scope:this},this.$("container").trigger(e),this},addIdleState:function(t,e){return this._idle.add.apply(this._idle,C.array(arguments)),this},removeIdleState:function(t){return this._idle.remove.apply(this._idle,C.array(arguments)),this},enterIdleMode:function(){return this._idle.hide(),this},exitIdleMode:function(){return this._idle.showAll(),this},enterFullscreen:function(t){return this._fullscreen.enter.apply(this,C.array(arguments)),this},exitFullscreen:function(t){return this._fullscreen.exit.apply(this,C.array(arguments)),this},toggleFullscreen:function(t){return this._fullscreen[this.isFullscreen()?"exit":"enter"].apply(this,C.array(arguments)),this},bindTooltip:function(t,e){return this._tooltip.bind.apply(this._tooltip,C.array(arguments)),this},defineTooltip:function(t,e){return this._tooltip.define.apply(this._tooltip,C.array(arguments)),this},refreshTooltip:function(t){return this._tooltip.show.apply(this._tooltip,C.array(arguments)),this},openLightbox:function(){return this._lightbox.show.apply(this._lightbox,C.array(arguments)),this},closeLightbox:function(){return this._lightbox.hide.apply(this._lightbox,C.array(arguments)),this},getActiveImage:function(){return this._getActive().image||e},getActiveThumb:function(){return this._thumbnails[this._active].image||e},getMousePosition:function(t){return{x:t.pageX-this.$("container").offset().left,y:t.pageY-this.$("container").offset().top}},addPan:function(e){if(!1!==this._options.imageCrop){e=t(e||this.getActiveImage());var i=this,n=e.width()/2,a=e.height()/2,o=parseInt(e.css("left"),10),r=parseInt(e.css("top"),10),s=o||0,l=r||0,c=0,h=0,u=!1,d=C.timestamp(),g=0,f=0,m=function(t,i,n){if(t>0&&(f=Math.round(Math.max(-1*t,Math.min(0,i))),g!==f))if(g=f,8===p)e.parent()["scroll"+n](-1*f);else{var a={};a[n.toLowerCase()]=f,e.css(a)}},y=function(t){C.timestamp()-d<50||(u=!0,n=i.getMousePosition(t).x,a=i.getMousePosition(t).y)};return 8===p&&(e.parent().scrollTop(-1*l).scrollLeft(-1*s),e.css({top:0,left:0})),this.$("stage").unbind("mousemove",y).bind("mousemove",y),C.addTimer("pan",function(t){u&&(c=e.width()-i._stageWidth,h=e.height()-i._stageHeight,o=n/i._stageWidth*c*-1,r=a/i._stageHeight*h*-1,s+=(o-s)/i._options.imagePanSmoothness,l+=(r-l)/i._options.imagePanSmoothness,m(h,l,"Top"),m(c,s,"Left"))},50,!0),this}},proxy:function(t,e){return"function"!=typeof t?function(){}:(e=e||this,function(){return t.apply(e,C.array(arguments))})},removePan:function(){return this.$("stage").unbind("mousemove"),C.clearTimer("pan"),this},addElement:function(e){var i=this._dom;return t.each(C.array(arguments),function(t,e){i[e]=C.create("galleria-"+e)}),this},attachKeyboard:function(t){return this._keyboard.attach.apply(this._keyboard,C.array(arguments)),this},detachKeyboard:function(){return this._keyboard.detach.apply(this._keyboard,C.array(arguments)),this},appendChild:function(t,e){return this.$(t).append(this.get(e)||e),this},prependChild:function(t,e){return this.$(t).prepend(this.get(e)||e),this},remove:function(t){return this.$(C.array(arguments).join(",")).remove(),this},append:function(t){var e,i;for(e in t)if(t.hasOwnProperty(e))if(t[e].constructor===Array)for(i=0;t[e][i];i++)this.appendChild(e,t[e][i]);else this.appendChild(e,t[e]);return this},_scaleImage:function(e,i){e=e||this._controls.getActive();var n,a=function(e){t(e.container).children(":first").css({top:Math.max(0,C.parseValue(e.image.style.top)),left:Math.max(0,C.parseValue(e.image.style.left)),width:C.parseValue(e.image.width),height:C.parseValue(e.image.height)})};return i=t.extend({width:this._stageWidth,height:this._stageHeight,crop:this._options.imageCrop,max:this._options.maxScaleRatio,min:this._options.minScaleRatio,margin:this._options.imageMargin,position:this._options.imagePosition},i),this._options.layerFollow&&!0!==this._options.imageCrop?"function"==typeof i.complete?(n=i.complete,i.complete=function(){n.call(e,e),a(e)}):i.complete=a:t(e.container).children(":first").css({top:0,left:0}),e.scale(i),this},updateCarousel:function(){return this._carousel.update(),this},rescale:function(t,i,n){var a=this;"function"==typeof t&&(n=t,t=e);var o=function(){a._stageWidth=t||a.$("stage").width(),a._stageHeight=i||a.$("stage").height(),a._scaleImage(),a._options.carousel&&a.updateCarousel(),a.trigger(Galleria.RESCALE),"function"==typeof n&&n.call(a)};return!Galleria.WEBKIT||t||i?o.call(a):C.addTimer("scale",o,10),this},refreshImage:function(){return this._scaleImage(),this._options.imagePan&&this.addPan(),this},show:function(t,e,i){if(!1!==t&&(this._options.queue||!this._queue.stalled)){if(t=Math.max(0,Math.min(parseInt(t,10),this.getDataLength()-1)),e=void 0!==e?!!e:t<this.getIndex(),(i=i||!1)||!Galleria.History)return this._active=t,Array.prototype.push.call(this._queue,{index:t,rewind:e}),this._queue.stalled||this._show(),this;Galleria.History.set(t.toString())}},_show:function(){var i=this,n=this._queue[0],o=this.getData(n.index);if(o){var r=this.isFullscreen()&&"big"in o?o.big:o.image,s=this._controls.getActive(),l=this._controls.getNext(),c=l.isCached(r),h=this._thumbnails[n.index],u=function(e,n,o,r,s){return function(){i._queue.stalled=!1,C.toggleQuality(n.image,i._options.imageQuality),i._layers[i._controls.active].innerHTML="",t(o.container).css({zIndex:0,opacity:0}).show(),t(n.container).css({zIndex:1}).show(),i._controls.swap(),i._options.imagePan&&i.addPan(n.image),(e.link||i._options.lightbox)&&t(n.image).css({cursor:"pointer"}).bind("mouseup",function(){e.link?i._options.popupLinks?a.open(e.link,"_blank"):a.location.href=e.link:i.openLightbox()}),Array.prototype.shift.call(i._queue),i._queue.length&&i._show(),i._playCheck(),i.trigger({type:Galleria.IMAGE,index:r.index,imageTarget:n.image,thumbTarget:s.image})}}(o,l,s,n,h);if(this._options.carousel&&this._options.carouselFollow&&this._carousel.follow(n.index),this._options.preload){var d,p,g,f=this.getNext();try{for(p=this._options.preload;p>0;p--)d=new Galleria.Picture,g=i.getData(f),d.preload(this.isFullscreen()&&"big"in g?g.big:g.image),f=i.getNext(f)}catch(t){}}C.show(l.container),t(i._thumbnails[n.index].container).addClass("active").siblings(".active").removeClass("active"),i.trigger({type:Galleria.LOADSTART,cached:c,index:n.index,rewind:n.rewind,imageTarget:l.image,thumbTarget:h.image}),l.load(r,function(a){t(i._layers[1-i._controls.active]).html(o.layer||"").hide(),i._scaleImage(a,{complete:function(a){"image"in s&&C.toggleQuality(s.image,!1),C.toggleQuality(a.image,!1),i._queue.stalled=!0,i.removePan(),i.setInfo(n.index),i.setCounter(n.index),o.layer&&t(i._layers[1-i._controls.active]).show(),i.trigger({type:Galleria.LOADFINISH,cached:c,index:n.index,rewind:n.rewind,imageTarget:a.image,thumbTarget:i._thumbnails[n.index].image});var r=i._options.transition;if(t.each({initial:null===s.image,touch:Galleria.TOUCH,fullscreen:i.isFullscreen()},function(t,n){if(n&&i._options[t+"Transition"]!==e)return r=i._options[t+"Transition"],!1}),r in I==!1)u();else{var l={prev:s.container,next:a.container,rewind:n.rewind,speed:i._options.transitionSpeed||400};I[r].call(i,l,u)}}})})}},getNext:function(t){return(t="number"==typeof t?t:this.getIndex())===this.getDataLength()-1?0:t+1},getPrev:function(t){return 0===(t="number"==typeof t?t:this.getIndex())?this.getDataLength()-1:t-1},next:function(){return this.getDataLength()>1&&this.show(this.getNext(),!1),this},prev:function(){return this.getDataLength()>1&&this.show(this.getPrev(),!0),this},get:function(t){return t in this._dom?this._dom[t]:null},getData:function(t){return t in this._data?this._data[t]:this._data[this._active]},getDataLength:function(){return this._data.length},getIndex:function(){return"number"==typeof this._active&&this._active},getStageHeight:function(){return this._stageHeight},getStageWidth:function(){return this._stageWidth},getOptions:function(t){return void 0===t?this._options:this._options[t]},setOptions:function(e,i){return"object"==typeof e?t.extend(this._options,e):this._options[e]=i,this},play:function(t){return this._playing=!0,this._playtime=t||this._playtime,this._playCheck(),this.trigger(Galleria.PLAY),this},pause:function(){return this._playing=!1,this.trigger(Galleria.PAUSE),this},playToggle:function(t){return this._playing?this.pause():this.play(t)},isPlaying:function(){return this._playing},isFullscreen:function(){return this._fullscreen.active},_playCheck:function(){var t=this,e=0,i=C.timestamp(),n="play"+this._id;if(this._playing){C.clearTimer(n);var a=function(){if((e=C.timestamp()-i)>=t._playtime&&t._playing)return C.clearTimer(n),void t.next();t._playing&&(t.trigger({type:Galleria.PROGRESS,percent:Math.ceil(e/t._playtime*100),seconds:Math.floor(e/1e3),milliseconds:e}),C.addTimer(n,a,20))};C.addTimer(n,a,20)}},setPlaytime:function(t){return this._playtime=t,this},setIndex:function(t){return this._active=t,this},setCounter:function(t){if("number"==typeof t?t++:void 0===t&&(t=this.getIndex()+1),this.get("current").innerHTML=t,p){var e=this.$("counter"),i=e.css("opacity");1===parseInt(i,10)?C.removeAlpha(e[0]):this.$("counter").css("opacity",i)}return this},setInfo:function(e){var i=this,n=this.getData(e);return t.each(["title","description"],function(t,e){var a=i.$("info-"+e);n[e]?a[n[e].length?"show":"hide"]().html(n[e]):a.empty().hide()}),this},hasInfo:function(t){var e,i="title description".split(" ");for(e=0;i[e];e++)if(this.getData(t)[i[e]])return!0;return!1},jQuery:function(e){var i=this,n=[];t.each(e.split(","),function(e,a){a=t.trim(a),i.get(a)&&n.push(a)});var a=t(i.get(n.shift()));return t.each(n,function(t,e){a=a.add(i.get(e))}),a},$:function(t){return this.jQuery.apply(this,C.array(arguments))}},t.each(m,function(t,e){var i=/_/.test(e)?e.replace(/_/g,""):e;Galleria[e.toUpperCase()]="galleria."+i}),t.extend(Galleria,{IE9:9===p,IE8:8===p,IE7:7===p,IE6:6===p,IE:p,WEBKIT:/webkit/.test(u),SAFARI:/safari/.test(u),CHROME:/chrome/.test(u),QUIRK:p&&o.compatMode&&"BackCompat"===o.compatMode,MAC:/mac/.test(navigator.platform.toLowerCase()),OPERA:!!a.opera,IPHONE:/iphone/.test(u),IPAD:/ipad/.test(u),ANDROID:/android/.test(u),TOUCH:"ontouchstart"in o}),Galleria.addTheme=function(e){e.name||Galleria.raise("No theme name specified"),"object"!=typeof e.defaults?e.defaults={}:e.defaults=y(e.defaults);var i=!1;return"string"==typeof e.css?(t("link").each(function(t,n){if(new RegExp(e.css).test(n.href))return i=!0,G(e),!1}),i||t("script").each(function(t,n){new RegExp("galleria\\."+e.name.toLowerCase()+"\\.").test(n.src)&&(i=n.src.replace(/[^\/]*$/,"")+e.css,C.addTimer("css",function(){C.loadCSS(i,"galleria-theme",function(){G(e)})},1))}),i||Galleria.raise("No theme CSS loaded")):G(e),e},Galleria.loadTheme=function(i,n){var o=b.length,r=a.setTimeout(function(){Galleria.raise("Theme at "+i+" could not load, check theme path.",!0)},5e3);Galleria.theme=e,C.loadScript(i,function(){if(a.clearTimeout(r),o){var e=[];t.each(Galleria.get(),function(i,a){var o=t.extend(a._original.options,{data_source:a._data},n);a.$("container").remove();var r=new Galleria;r._id=a._id,r.init(a._original.target,o),e.push(r)}),b=e}})},Galleria.get=function(t){return x[t]?x[t]:"number"!=typeof t?x:void Galleria.raise("Gallery index "+t+" not found")},Galleria.addTransition=function(t,e){I[t]=e},Galleria.utils=C,Galleria.log="console"in a&&"log"in a.console?a.console.log:function(){a.alert(C.array(arguments).join(", "))},Galleria.ready=function(e){t.each(b,function(t,i){e.call(i,i._options)}),Galleria.ready.callbacks.push(e)},Galleria.ready.callbacks=[],Galleria.raise=function(e,i){var n=i?"Fatal error":"Error",a=function(e){var a='<div style="padding:4px;margin:0 0 2px;background:#'+(i?"811":"222")+'";>'+(i?"<strong>"+n+": </strong>":"")+e+"</div>";t.each(x,function(){var t=this.$("errors"),e=this.$("target");t.length||(e.css("position","relative"),t=this.addElement("errors").appendChild("target","errors").$("errors").css({color:"#fff",position:"absolute",top:0,left:0,zIndex:1e5})),t.append(a)})};if(l){if(a(e),i)throw new Error(n+": "+e)}else if(i){if(w)return;w=!0,i=!1,a("Image gallery could not load.")}},Galleria.version=1.25,Galleria.requires=function(t,e){e=e||"You need to upgrade Galleria to version "+t+" to use one or more components.",Galleria.version<t&&Galleria.raise(e,!0)},Galleria.Picture=function(e){this.id=e||null,this.image=null,this.container=C.create("galleria-image"),t(this.container).css({overflow:"hidden",position:"relative"}),this.original={width:0,height:0},this.ready=!1,this.tid=null},Galleria.Picture.prototype={cache:{},show:function(){C.show(this.image)},hide:function(){C.moveOut(this.image)},clear:function(){this.image=null},isCached:function(t){return!!this.cache[t]},preload:function(e){t(new Image).load(function(t,e){return function(){e[t]=t}}(e,this.cache)).attr("src",e)},load:function(e,i){this.tid=a.setTimeout(function(t){return function(){Galleria.raise("Image not loaded in "+Math.round(c/1e3)+" seconds: "+t)}}(e),c),this.image=new Image;var n=!1,o=t(this.container),r=t(this.image),s=function(t,e,i){return function(){var n,o=function(){t.original={height:this.height,width:this.width},t.cache[i]=i,a.clearTimeout(t.tid),"function"==typeof e&&a.setTimeout(function(){e.call(t,t)},1)};this.width&&this.height?o.call(this):a.setTimeout((n=this,function(){n.width&&n.height?o.call(n):Galleria.raise("Could not extract width/height from image: "+n.src+". Traced measures: width:"+n.width+"px, height: "+n.height+"px.")}),2)}}(this,i,e);return o.find("img").remove(),r.css("display","block").appendTo(this.container),C.hide(this.image),this.cache[e]?(this.image.src=e,s.call(this.image),this.container):(t(this.image).load(s).error(function(){n?h?t(this).attr("src",h):Galleria.raise("Image not found: "+e):(n=!0,a.setTimeout(function(t,e){return function(){t.attr("src",e+"?"+C.timestamp())}}(t(this),e),50))}).attr("src",e),this.container)},scale:function(i){if(i=t.extend({width:0,height:0,min:e,max:e,margin:0,complete:function(){},position:"center",crop:!1,canvas:!1},i),!this.image)return this.container;var n,a,o,r=this,s=t(r.container);return C.wait({until:function(){return n=i.width||s.width()||C.parseValue(s.css("width")),a=i.height||s.height()||C.parseValue(s.css("height")),n&&a},success:function(){var e=(n-2*i.margin)/r.original.width,s=(a-2*i.margin)/r.original.height,l={true:Math.max(e,s),width:e,height:s,false:Math.min(e,s)}[i.crop.toString()],c="";i.max&&(l=Math.min(i.max,l)),i.min&&(l=Math.max(i.min,l)),t.each(["width","height"],function(e,i){t(r.image)[i](r[i]=r.image[i]=Math.round(r.original[i]*l))}),t(r.container).width(n).height(a),i.canvas&&T&&(T.elem.width=r.width,T.elem.height=r.height,c=r.image.src+":"+r.width+"x"+r.height,r.image.src=T.cache[c]||function(t){T.context.drawImage(r.image,0,0,r.original.width*l,r.original.height*l);try{return o=T.elem.toDataURL(),T.length+=o.length,T.cache[t]=o,o}catch(t){return r.image.src}}(c));var h={},u={},d=function(e,i,n){var a=0;if(/\%/.test(e)){var o=parseInt(e,10)/100,s=r.image[i]||t(r.image)[i]();a=Math.ceil(-1*s*o+n*o)}else a=C.parseValue(e);return a},p={top:{top:0},left:{left:0},right:{left:"100%"},bottom:{top:"100%"}};t.each(i.position.toLowerCase().split(" "),function(t,e){"center"===e&&(e="50%"),h[t?"top":"left"]=e}),t.each(h,function(e,i){p.hasOwnProperty(i)&&t.extend(u,p[i])}),h=h.top?t.extend(h,u):u,h=t.extend({top:"50%",left:"50%"},h),t(r.image).css({position:"absolute",top:d(h.top,"height",a),left:d(h.left,"width",n)}),r.show(),r.ready=!0,i.complete.call(r,r)},error:function(){Galleria.raise("Could not scale image: "+r.image.src)},timeout:1e3}),this}},t.extend(t.easing,{galleria:function(t,e,i,n,a){return(e/=a/2)<1?n/2*e*e*e+i:n/2*((e-=2)*e*e+2)+i},galleriaIn:function(t,e,i,n,a){return n*(e/=a)*e+i},galleriaOut:function(t,e,i,n,a){return-n*(e/=a)*(e-2)+i}}),t.fn.galleria=function(e){return this.each(function(){t(this).data("galleria",(new Galleria).init(this,e))})}}(jQuery);
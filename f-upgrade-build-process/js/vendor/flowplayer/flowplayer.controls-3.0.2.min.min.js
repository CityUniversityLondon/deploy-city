$f.addPlugin("controls",function(n,t){function e(n){return void 0===n&&(n=window.event),void 0===n.layerX&&(n.layerX=n.offsetX),void 0===n.layerY&&(n.layerY=n.offsetY),n}function a(n){return n.clientWidth}function s(n){return n.offsetLeft}function r(t){for(var e=n.getElementsByTagName("*"),a=new RegExp("(^|\\s)"+t+"(\\s|$)"),s=0;s<e.length;s++)if(a.test(e[s].className))return e[s]}function o(n){return(n=parseInt(n,10))>=10?n:"0"+n}function u(n){var t=Math.floor(n/3600),e=Math.floor(n/60);return n-=60*e,t>=1?(e-=60*t,o(t)+":"+o(e)+":"+o(n)):o(e)+":"+o(n)}function i(n,t){return"<span>"+u(n)+"</span> <strong>"+u(t)+"</strong>"}var l=this,c={playHeadClass:"playhead",trackClass:"track",playClass:"play",pauseClass:"pause",bufferClass:"buffer",progressClass:"progress",timeClass:"time",muteClass:"mute",unmuteClass:"unmute",duration:0,template:'<a class="play">play</a><div class="track"><div class="buffer"></div><div class="progress"></div><div class="playhead"></div></div><div class="time"></div><a class="mute">mute</a>'};if(function(n,t){if(t)for(key in t)key&&(n[key]=t[key])}(c,t),"string"==typeof n&&(n=document.getElementById(n)),n){n.innerHTML.replace(/\s/g,"")||(n.innerHTML=c.template);var f=r(c.playHeadClass),d=r(c.bufferClass),m=r(c.progressClass),g=r(c.trackClass),p=r(c.timeClass),v=r(c.muteClass);p.innerHTML=i(0,c.duration);var y=a(g),C=a(f),h=new function(n,t,a,s){var r=!1;function o(){}function u(e){return!(e>a||e<t||(n.style.left=e+"px",0))}function i(){document.onmousemove=null,document.onmouseup=null,n.onDragEnd(parseInt(n.style.left,10)),r=!1}function l(t){var a=(t=e(t)).clientX-s;return u(a)&&(r=!0,n.onDrag(a)),!1}return n.onDragStart=n.onDragStart||o,n.onDragEnd=n.onDragEnd||o,n.onDrag=n.onDrag||o,n.onmousedown=function(t){return t=e(t),n.onDragStart(parseInt(n.style.left,10)),document.onmousemove=l,document.onmouseup=i,!1},this.dragTo=function(t){u(t)&&n.onDragEnd(t)},this.setMax=function(n){a=n},this.isDragging=function(){return r},this}(f,0,0,s(n)+s(g)+C/2);g.onclick=function(n){if((n=e(n)).target==f)return!1;h.dragTo(n.layerX-C/2)};var D=r(c.playClass);D.onclick=function(){l.isLoaded()?l.toggle():l.play()},v.onclick=function(){l.getStatus().muted?l.unmute():l.mute()};var k=null;return l.onStart(function(n){var t=n.duration||0;clearInterval(k),k=setInterval(function(){var e=l.getStatus();if(e.time&&(p.innerHTML=i(e.time,n.duration)),void 0!==e.time){var a=M(e.bufferEnd,t);d.style.width=a+"px",h.setMax(a),l.isPaused()||h.isDragging()||(a=M(e.time,t),m.style.width=a+"px",f.style.left=a-C/2+"px")}else clearInterval(k)},500)}),l.onBegin(function(){D.className=c.pauseClass}),l.onPause(function(){D.className=c.playClass}),l.onResume(function(){D.className=c.pauseClass}),l.onMute(function(){v.className=c.unmuteClass}),l.onUnmute(function(){v.className=c.muteClass}),l.onFinish(function(n){clearInterval(k)}),l.onUnload(function(){p.innerHTML=i(0,c.duration)}),f.onDragEnd=function(n){var t=parseInt(n/y*100,10)+"%";m.style.width=n+"px",l.isLoaded()&&l.seek(t)},f.onDrag=function(n){m.style.width=n+"px"},l}function M(n,t){return parseInt(Math.min(n/t*y,y-C/2),10)}});
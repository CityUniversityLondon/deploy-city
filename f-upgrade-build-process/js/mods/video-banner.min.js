var defer=require("./utils/defer"),loadYoutubeVideo=require("./video-preview-youtube"),getDataAttributes=function(e){var t=/^data-(.+)$/,r={};return $.each(e[0].attributes,function(e,i){var a=i.name.match(t);a&&(r[a[1]]=i.value)}),r},getService=function(e){var t=e.attr("href")||"",r=getDataAttributes(e),i=t.match(/(?:https?:\/\/)?(?:www\.)?youtu\.?be(?:\.com)?\/?.*(?:watch|embed)?(?:.*v=|v\/|\/)([\w\-_]+)\&?/);return i?{type:"youtube",id:i[1],params:r}:null},loadVideo=function(e,t){switch(t.type){case"youtube":return loadYoutubeVideo(e,t);default:return!1}},init=function(){var e=$(".video-preview__button");if(e.length){var t=getService(e);if(t){var r=e.parent(),i=null;r.hasClass("video-preview")?i=r:(i=$("<div/>").addClass("video-preview").insertBefore(e)).append(e),e.on("click",function(e){e.preventDefault(),loadVideo(i,t)})}}};defer(init);